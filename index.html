<!DOCTYPE html>
<html>
<head>
  <title>Madden Style Football</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      background-color: #f0f0f0;
      padding: 20px;
    }
    h1 {
      color: #333;
    }
    button, select {
      display: block;
      margin: 10px auto;
      padding: 10px;
      font-size: 18px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      background-color: #007bff;
      color: white;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #0056b3;
    }
    label {
      font-size: 16px;
      margin-top: 15px;
      display: block;
    }
    select {
      background-color: #fff;
      color: #333;
      border: 1px solid #ccc;
    }
    #game {
      max-width: 600px;
      margin: auto;
      background-color: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    #scoreboard, #situation {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 20px;
    }
    #offensePlays, #defensePlays, #fourthDownOptions {
      margin-top: 20px;
    }
  </style>
</head>
<body>
<h1>Madden Style Football</h1>

<!-- Main Menu -->
<div id="menu" role="navigation" aria-label="Main Menu">
  <button id="quickPlayBtn" aria-label="Start Quick Play">Quick Play</button>
  <button id="franchiseBtn" aria-label="Start Franchise Mode">Franchise</button>
</div>

<!-- Team Selection -->
<div id="teamSelection" style="display:none;" aria-label="Team Selection">
  <h3>Select Teams</h3>
  <label for="homeTeamSelect">Home Team:</label>
  <select id="homeTeamSelect">
    <option value="49ers" selected>49ers</option>
    <option value="Cowboys">Cowboys</option>
    <option value="Eagles">Eagles</option>
    <option value="Packers">Packers</option>
    <option value="Giants">Giants</option>
  </select>

  <label for="awayTeamSelect">Away Team:</label>
  <select id="awayTeamSelect">
    <option value="Cowboys">Cowboys</option>
    <option value="Eagles">Eagles</option>
    <option value="Packers">Packers</option>
    <option value="Giants">Giants</option>
    <option value="49ers">49ers</option>
  </select>

  <button id="startGameBtn" aria-label="Start Game">Start Game</button>
</div>

<!-- Game Screen -->
<div id="game" style="display:none;">
  <div id="scoreboard" aria-live="polite"></div>
  <div id="situation" aria-live="polite"></div>
  <div id="aiAnnounce" aria-live="polite" style="position:absolute; left:-9999px;"></div>

  <!-- Offensive Playbook -->
  <div id="offensePlays" style="display:none;" aria-label="Offensive Playbook">
    <h3>Offensive Playbook</h3>
    <button id="runPlayBtn" aria-label="Run Play">Run Play</button>
    <button id="shortPassBtn" aria-label="Short Pass Play">Short Pass</button>
    <button id="longPassBtn" aria-label="Long Pass Play">Long Pass</button>
  </div>

  <!-- Defensive Playbook -->
  <div id="defensePlays" style="display:none;" aria-label="Defensive Playbook">
    <h3>Defensive Playbook</h3>
    <button id="blitzBtn" aria-label="Blitz Defense">Blitz</button>
    <button id="zoneBtn" aria-label="Zone Defense">Zone</button>
    <button id="manBtn" aria-label="Man Coverage Defense">Man Coverage</button>
  </div>

  <!-- Fourth Down Options -->
  <div id="fourthDownOptions" style="display:none;" aria-label="Fourth Down Options">
    <h3>Fourth Down Options</h3>
    <button id="fieldGoalBtn" aria-label="Kick Field Goal">Kick Field Goal</button>
    <button id="puntBtn" aria-label="Punt Ball">Punt</button>
    <button id="goForItBtn" aria-label="Go For It on Fourth Down">Go For It</button>
  </div>

  <button id="nextQuarterBtn" aria-label="Next Quarter">Next Quarter</button>
</div>

<script>
window.onload = function() {
  let homeTeam = "49ers";
  let awayTeam = "Eagles";
  let homeScore = 0;
  let awayScore = 0;
  let possession = "home";
  let currentDown = 1;
  let yardsToFirst = 10;
  let ballPosition = 25;
  let quarter = 1;
  let defenseChoice = "zone";

  // Function to announce messages for screen readers.
  function announce(msg, ai=false) {
    const target = ai ? document.getElementById('aiAnnounce') : document.getElementById('situation');
    target.innerText = msg;
  }

  // Function to update the visual scoreboard.
  function updateScoreboard() {
    document.getElementById('scoreboard').innerText = `${homeTeam} ${homeScore} - ${awayScore} ${awayTeam}`;
  }

  // Function to update the on-screen situation text.
  function updateSituation() {
    let teamWithBall = (possession === "home") ? homeTeam : awayTeam;
    document.getElementById('situation').innerText =
      `${currentDown} and ${yardsToFirst} at the ${ballPosition} yard line. ${teamWithBall} ball.`;
  }

  // Starts a quick play game.
  function startQuickPlay() {
    document.getElementById('menu').style.display = 'none';
    document.getElementById('teamSelection').style.display = 'block';
    announce("Quick Play selected. Choose your home and away teams.");
  }

  // Starts the game with selected teams.
  function startGame() {
    homeTeam = document.getElementById('homeTeamSelect').value;
    awayTeam = document.getElementById('awayTeamSelect').value;
    homeScore = 0;
    awayScore = 0;
    possession = "home";
    currentDown = 1;
    yardsToFirst = 10;
    ballPosition = 25;
    quarter = 1;

    document.getElementById('teamSelection').style.display = 'none';
    document.getElementById('game').style.display = 'block';
    document.getElementById('offensePlays').style.display = 'block';
    document.getElementById('defensePlays').style.display = 'none';
    updateSituation();
    announce(`Game starting. ${homeTeam} vs ${awayTeam}. ${homeTeam} has the ball at the ${ballPosition} yard line.`);
  }

  // Placeholder for Franchise mode.
  function startFranchise() {
    announce("Franchise Mode coming soon!");
  }

  // Handles the logic for a single play.
  function callPlay(playType, ai=false) {
    let yards = 0;
    // Calculate yards based on play type and defense.
    if(playType==='run'){
      yards = Math.floor(Math.random()*3)+2;
      if(defenseChoice==="blitz") yards-=1;
    } else if(playType==='shortPass'){
      yards = Math.floor(Math.random()*6)+10;
      if(defenseChoice==="zone") yards-=5;
    } else if(playType==='longPass'){
      yards = Math.floor(Math.random()*11)+30;
      if(defenseChoice==="man") yards-=10;
    } else if(playType==='goForIt'){
      yards = Math.floor(Math.random()*10)+1;
    }
    if(yards<0) yards=0;

    let homeScoreBeforePlay = homeScore;
    let awayScoreBeforePlay = awayScore;

    ballPosition += yards;
    yardsToFirst -= yards;

    let msg = `${(possession==="home"?homeTeam:awayTeam)} gained ${yards} yards. `;

    let scored = false;
    if(ballPosition>=100){
      msg+="Touchdown!";
      scored=true;
      if(possession==="home") homeScore+=7; else awayScore+=7;
      changePossession(true);
    } else if(yardsToFirst<=0){
      currentDown=1;
      yardsToFirst=10;
      msg+="First down!";
    } else {
      currentDown++;
      if(currentDown>4){
        msg+="Turnover on downs.";
        changePossession();
      }
    }
    
    // Add score announcement to the message if the score changed.
    if (homeScore !== homeScoreBeforePlay || awayScore !== awayScoreBeforePlay) {
      msg += ` New score: ${homeTeam} ${homeScore}, ${awayTeam} ${awayScore}.`;
      updateScoreboard();
    }
    
    // Update the UI and make the announcement.
    updateSituation();
    announce(msg, ai);

    // AI logic for the opponent.
    if(possession!=="home" && !ai) autoPlay();
  }

  // Handles the logic for the AI opponent's turn.
  function autoPlay(){
    if(possession==="home") return;
    const plays=['run','shortPass','longPass'];
    let play = plays[Math.floor(Math.random()*plays.length)];
    setTimeout(()=>callPlay(play,true),500);
    setTimeout(autoPlay,1000);
  }

  // Changes possession of the ball.
  function changePossession(reset=false){
    possession = (possession==="home") ? "away" : "home";
    currentDown=1;
    yardsToFirst=10;
    ballPosition = reset ? 25 : 100-ballPosition;
    updateSituation();
    if(possession!=="home") autoPlay();
  }

  // Logic for a punt play.
  function punt(){
    let puntYards=Math.floor(Math.random()*20)+40;
    ballPosition=100-puntYards;
    changePossession();
    announce(`Punt goes ${puntYards} yards. ${(possession==="home"?homeTeam:awayTeam)} takes over at the ${ballPosition} yard line.`,true);
  }

  // Logic for a field goal play.
  function fieldGoal(){
    if(ballPosition>=60){
      announce(`Field goal is good! New score: ${homeTeam} ${homeScore + 3}, ${awayTeam} ${awayScore}.`,true);
      if(possession==="home") homeScore+=3; else awayScore+=3;
      updateScoreboard();
    } else {
      announce("Field goal is no good.",true);
    }
    changePossession(true);
  }

  // Advances to the next quarter.
  function nextQuarter(){
    quarter++;
    if(quarter===3) announce("Halftime show starting!");
    else if(quarter>4) announce(`Game Over! Final score: ${homeTeam} ${homeScore}, ${awayTeam} ${awayScore}`);
    else announce(`Starting Quarter ${quarter}`);
  }

  // Event listeners for all buttons.
  document.getElementById('quickPlayBtn').onclick=startQuickPlay;
  document.getElementById('franchiseBtn').onclick=startFranchise;
  document.getElementById('startGameBtn').onclick=startGame;
  document.getElementById('runPlayBtn').onclick=()=>callPlay('run');
  document.getElementById('shortPassBtn').onclick=()=>callPlay('shortPass');
  document.getElementById('longPassBtn').onclick=()=>callPlay('longPass');
  document.getElementById('blitzBtn').onclick=()=>{defenseChoice='blitz'; document.getElementById('defensePlays').style.display='none'; document.getElementById('offensePlays').style.display='block'; announce('Blitz defense set.');};
  document.getElementById('zoneBtn').onclick=()=>{defenseChoice='zone'; document.getElementById('defensePlays').style.display='none'; document.getElementById('offensePlays').style.display='block'; announce('Zone defense set.');};
  document.getElementById('manBtn').onclick=()=>{defenseChoice='man'; document.getElementById('defensePlays').style.display='none'; document.getElementById('offensePlays').style.display='block'; announce('Man coverage defense set.');};
  document.getElementById('fieldGoalBtn').onclick=fieldGoal;
  document.getElementById('puntBtn').onclick=punt;
  document.getElementById('goForItBtn').onclick=()=>callPlay('goForIt');
  document.getElementById('nextQuarterBtn').onclick=nextQuarter;

}
</script>
</body>
</html>