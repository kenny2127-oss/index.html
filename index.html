<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Accessible Pokémon Game — Full Base Updated</title>
<style>
:root{--nav:#333;--accent:#90ee90;--bg:#f0f8ff}
html,body{height:100%;margin:0;font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:#111;display:flex;flex-direction:column;}
main{flex:1;overflow:auto;padding:12px;}
header,footer{background:var(--nav);color:#fff;}
nav{display:flex;gap:0;position:fixed;bottom:0;width:100%;}
nav button{flex:1;padding:14px;border:0;background:transparent;color:inherit;font-size:16px;cursor:pointer;}
nav button.active{background:#222;outline:3px solid #ff0;}
.btn{display:inline-block;padding:10px 14px;margin:6px 4px;border:0;border-radius:8px;background:#1976d2;color:#fff;font-size:14px;cursor:pointer;}
.btn.alt{background:var(--accent);color:#000;}
.btn.ghost{background:transparent;border:1px solid #ccc;color:#000;}
ul{padding-left:18px;}
#pokedex-list{max-height:240px;overflow:auto;border:1px solid #ddd;padding:8px;background:#fff;}
#inventory-list{max-height:200px;overflow:auto;border:1px solid #ddd;padding:8px;background:#fff;}
#move-buttons button{display:block;width:100%;margin:6px 0;padding:10px;}
.panel{border:1px solid #ddd;padding:8px;background:#fff;border-radius:8px;}
.flex{display:flex;gap:8px;align-items:center;flex-wrap:wrap;}
label{display:block;margin:6px 0;}
select{padding:6px;border-radius:4px;}
@media(min-width:720px){main{padding:20px;}nav button{font-size:18px;}}
</style>
</head>
<body>
<main>
  <!-- HOME -->
  <section id="home" class="tab active" role="tabpanel">
    <h1>Home</h1>
    <p id="player-info" aria-live="polite">Level: 1 | Money: $1000 | Bank: $0</p>
    <div class="flex">
      <button id="open-pokedex" class="btn alt" aria-expanded="false">Open Pokedex</button>
      <button id="save-manual" class="btn ghost">Save Now</button>
      <button id="reset-game" class="btn ghost">Reset Save</button>
    </div>
    <div class="flex" style="margin-top:8px;">
      <button id="bank-deposit" class="btn alt">Deposit $100</button>
      <button id="bank-withdraw" class="btn alt">Withdraw $100</button>
    </div>

    <h2>Pokedex</h2>
    <div id="pokedex-list" class="panel" style="display:none" aria-live="polite"></div>
  </section>

  <!-- EXPLORE -->
  <section id="explore" class="tab" role="tabpanel">
    <h1>Explore</h1>
    <p>Search the wilds and try to catch Pokémon.</p>
    <div class="flex">
      <button id="catch-pokemon" class="btn alt">Search & Catch</button>
    </div>
    <p id="explore-log" aria-live="polite"></p>
  </section>

  <!-- GATHER -->
  <section id="gather" class="tab" role="tabpanel">
    <h1>Gather</h1>
    <p>Gather resources used for healing, evolving, and trading.</p>
    <div class="flex">
      <button id="gather-resource" class="btn alt">Gather Resource</button>
    </div>
    <p id="gather-log" aria-live="polite"></p>
  </section>

  <!-- BATTLE -->
  <section id="battle" class="tab" role="tabpanel">
    <h1>Battle</h1>
    <div class="flex">
      <button id="start-battle" class="btn alt">Start Battle</button>
      <div id="battle-controls" style="display:none;">
        <label for="select-player-poke">Choose your Pokémon:</label>
        <select id="select-player-poke" aria-label="Choose your Pokémon to send"></select>
        <button id="send-out" class="btn">Send Out</button>
      </div>
    </div>

    <div id="battle-area" style="margin-top:12px;display:none;">
      <div class="panel" id="battle-stats" aria-live="polite"></div>
      <div id="move-buttons" style="margin-top:10px;"></div>
    </div>
    <p id="battle-log" aria-live="assertive" style="white-space:pre-wrap;margin-top:10px;"></p>
  </section>

  <!-- TRADE -->
  <section id="trade" class="tab" role="tabpanel">
    <h1>Trade</h1>
    <label for="trade-mode">Choose Mode:</label>
    <select id="trade-mode">
      <option value="buy">Buy Items</option>
      <option value="sell">Sell Items</option>
    </select>

    <div id="trade-panel" class="panel" style="margin-top:10px;"></div>
  </section>

  <footer style="margin-top:18px;font-size:13px;color:#444">Accessible Pokémon Game — merged base (local file)</footer>
</main>

<nav role="tablist" aria-label="Main tabs">
  <button class="tab-btn active" data-target="home" role="tab" aria-controls="home">Home</button>
  <button class="tab-btn" data-target="explore" role="tab" aria-controls="explore">Explore</button>
  <button class="tab-btn" data-target="gather" role="tab" aria-controls="gather">Gather</button>
  <button class="tab-btn" data-target="battle" role="tab" aria-controls="battle">Battle</button>
  <button class="tab-btn" data-target="trade" role="tab" aria-controls="trade">Trade</button>
</nav>

<script>
// ------------------ Player state ------------------
const DEFAULT_PLAYER = { level:1, money:1000, bank:0, inventory:[], pokemon:[] };
let player = loadPlayer();

function savePlayer(){ localStorage.setItem('pkm_player_v2', JSON.stringify(player)); updateUI(); }
function loadPlayer(){ try{ const s=localStorage.getItem('pkm_player_v2'); return s?JSON.parse(s): structuredClone(DEFAULT_PLAYER);}catch(e){return structuredClone(DEFAULT_PLAYER);} }
function resetPlayer(){ if(confirm('Reset save? This will clear progress.')){ player=structuredClone(DEFAULT_PLAYER); savePlayer(); location.reload(); } }
function updateUI(){ document.getElementById('player-info').innerText=`Level: ${player.level} | Money: $${player.money} | Bank: $${player.bank}`; updateInventoryUI(); }

// save/reset buttons
document.getElementById('save-manual').addEventListener('click', ()=>{ savePlayer(); alert('Saved.'); });
document.getElementById('reset-game').addEventListener('click', resetPlayer);

// ------------------ Pokémon data subset ------------------
const pokemonData = [
  {"id":1,"name":"Bulbasaur","types":["Grass","Poison"],"baseStats":{"hp":45,"attack":49,"defense":49,"speed":45,"special":65},"moves":[{"name":"Tackle","type":"Normal","power":35,"accuracy":95},{"name":"Growl","type":"Status","power":0,"accuracy":100},{"name":"Leech Seed","type":"Grass","power":0,"accuracy":90},{"name":"Vine Whip","type":"Grass","power":45,"accuracy":100}]},
  {"id":2,"name":"Ivysaur","types":["Grass","Poison"],"baseStats":{"hp":60,"attack":62,"defense":63,"speed":60,"special":80},"moves":[{"name":"Tackle","type":"Normal","power":35,"accuracy":95},{"name":"Growl","type":"Status","power":0,"accuracy":100},{"name":"Leech Seed","type":"Grass","power":0,"accuracy":90},{"name":"Vine Whip","type":"Grass","power":45,"accuracy":100}]} // ...expand as needed
];

// ------------------ Pokedex ------------------
const pokedexBtn = document.getElementById('open-pokedex');
const pokedexListEl = document.getElementById('pokedex-list');
function buildPokedex(){
  pokedexListEl.innerHTML='';
  pokemonData.forEach(p=>{
    const node=document.createElement('div');
    node.tabIndex=0; node.style.padding='6px 4px';
    node.style.borderBottom='1px solid #eee';
    node.setAttribute('role','button');
    node.setAttribute('aria-label',`${p.name}. Types: ${p.types.join(', ')}.`);
    node.textContent=`${p.id.toString().padStart(3,'0')} — ${p.name} (${p.types.join('/')})`;
    node.addEventListener('click', ()=>alert(`Stats: HP ${p.baseStats.hp}, Atk ${p.baseStats.attack}`));
    node.addEventListener('keypress', e=>{if(e.key==='Enter') alert(`Stats: HP ${p.baseStats.hp}, Atk ${p.baseStats.attack}`)});
    pokedexListEl.appendChild(node);
  });
}
pokedexBtn.addEventListener('click', ()=>{
  const visible = pokedexListEl.style.display==='block';
  if(!visible){ buildPokedex(); pokedexListEl.style.display='block'; pokedexBtn.innerText='Close Pokedex'; pokedexBtn.setAttribute('aria-expanded','true'); }
  else{ pokedexListEl.style.display='none'; pokedexBtn.innerText='Open Pokedex'; pokedexBtn.setAttribute('aria-expanded','false'); }
});

// ------------------ Explore ------------------
const exploreLog=document.getElementById('explore-log');
document.getElementById('catch-pokemon').addEventListener('click', ()=>{
  const wild = pokemonData[Math.floor(Math.random()*pokemonData.length)];
  exploreLog.innerText=`A wild ${wild.name} appeared!`;
  setTimeout(()=>{
    const success = Math.random()<0.7;
    if(success){ player.pokemon.push(wild.name); savePlayer(); exploreLog.innerText=`You caught ${wild.name}!`; }
    else{ explore