<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Accessible Pokémon Game — Fully Merged</title>
<style>
:root{--nav:#333;--accent:#90ee90;--bg:#f0f8ff}
html,body{height:100%;margin:0;font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:#111;display:flex;flex-direction:column;}
main{flex:1;overflow:auto;padding:12px;}
header,footer{background:var(--nav);color:#fff;}
nav{display:flex;gap:0;position:fixed;bottom:0;width:100%;}
nav button{flex:1;padding:14px;border:0;background:transparent;color:inherit;font-size:16px;cursor:pointer;}
nav button.active{background:#222;outline:3px solid #ff0;}
.btn{display:inline-block;padding:10px 14px;margin:6px 4px;border:0;border-radius:8px;background:#1976d2;color:#fff;font-size:14px;cursor:pointer;}
.btn.alt{background:var(--accent);color:#000;}
.btn.ghost{background:transparent;border:1px solid #ccc;color:#000;}
.panel{border:1px solid #ddd;padding:8px;background:#fff;border-radius:8px;}
.flex{display:flex;gap:8px;align-items:center;flex-wrap:wrap;}
label{display:block;margin:6px 0;}
select{padding:6px;border-radius:4px;}
@media(min-width:720px){main{padding:20px;}nav button{font-size:18px;}}
</style>
</head>
<body>
<main>
<!-- HOME -->
<section id="home" class="tab" role="tabpanel">
  <h1>Home</h1>
  <p id="player-info" aria-live="polite">Level: 1 | XP: 0 | Money: $1000 | Bank: $0</p>
  <div class="flex">
    <button id="open-pokedex" class="btn alt" aria-expanded="false">Open Pokedex</button>
    <button id="save-manual" class="btn ghost">Save Now</button>
    <button id="reset-game" class="btn ghost">Reset Save</button>
  </div>
  <div class="flex" style="margin-top:8px;">
    <label for="bank-actions">Bank:</label>
    <select id="bank-actions">
      <option value="">Select</option>
      <option value="deposit10">Deposit $10</option>
      <option value="deposit20">Deposit $20</option>
      <option value="deposit50">Deposit $50</option>
      <option value="depositAll">Deposit All</option>
      <option value="withdraw10">Withdraw $10</option>
      <option value="withdraw20">Withdraw $20</option>
      <option value="withdraw50">Withdraw $50</option>
      <option value="withdrawAll">Withdraw All</option>
    </select>
  </div>
  <h2>Pokedex</h2>
  <div id="pokedex-list" class="panel" style="display:none" aria-live="polite"></div>
</section>

<!-- INVENTORY -->
<section id="inventory" class="tab" role="tabpanel">
  <h1>Inventory</h1>
  <div id="inventory-list" class="panel" aria-live="polite"></div>
</section>

<!-- EXPLORE -->
<section id="explore" class="tab" role="tabpanel">
  <h1>Explore</h1>
  <p>Search the wilds and try to catch Pokémon.</p>
  <div class="flex">
    <button id="catch-pokemon" class="btn alt">Search & Catch</button>
  </div>
  <p id="explore-log" aria-live="polite"></p>
</section>

<!-- GATHER -->
<section id="gather" class="tab" role="tabpanel">
  <h1>Gather</h1>
  <p>Gather resources used for healing, evolving, and trading.</p>
  <div class="flex">
    <button id="gather-resource" class="btn alt">Gather Resource</button>
  </div>
  <p id="gather-log" aria-live="polite"></p>
</section>

<!-- BATTLE -->
<section id="battle" class="tab" role="tabpanel">
  <h1>Battle</h1>
  <div class="flex">
    <button id="start-battle" class="btn alt">Start Battle</button>
  </div>
  <div id="battle-area" style="margin-top:12px;display:none;">
    <div class="panel" id="battle-stats" aria-live="polite"></div>
    <div id="move-buttons" style="margin-top:10px;"></div>
  </div>
  <p id="battle-log" aria-live="assertive" style="white-space:pre-wrap;margin-top:10px;"></p>
</section>

<!-- TRADE -->
<section id="trade" class="tab" role="tabpanel">
  <h1>Trade</h1>
  <div class="flex">
    <button id="sell-all-top" class="btn alt">Sell All Sellable Items</button>
  </div>
  <label for="trade-mode">Choose Mode:</label>
  <select id="trade-mode">
    <option value="buy">Buy Items</option>
    <option value="sell">Sell Items</option>
  </select>
  <div id="trade-panel" class="panel" style="margin-top:10px;"></div>
</section>

<footer style="margin-top:18px;font-size:13px;color:#444">Accessible Pokémon Game — Fully Functional</footer>
</main>

<nav role="tablist" aria-label="Main tabs">
  <button class="tab-btn active" data-target="home" role="tab" aria-controls="home">Home</button>
  <button class="tab-btn" data-target="inventory" role="tab" aria-controls="inventory">Inventory</button>
  <button class="tab-btn" data-target="explore" role="tab" aria-controls="explore">Explore</button>
  <button class="tab-btn" data-target="gather" role="tab" aria-controls="gather">Gather</button>
  <button class="tab-btn" data-target="battle" role="tab" aria-controls="battle">Battle</button>
  <button class="tab-btn" data-target="trade" role="tab" aria-controls="trade">Trade</button>
</nav>

<script>
// ------------------ Player state ------------------
const DEFAULT_PLAYER = { level:1, xp:0, money:1000, bank:0, inventory:{}, pokemon:[] };
let player = loadPlayer();

function savePlayer(){ localStorage.setItem('pkm_player_v6', JSON.stringify(player)); updateUI(); }
function loadPlayer(){ try{ const s=localStorage.getItem('pkm_player_v6'); return s?JSON.parse(s): structuredClone(DEFAULT_PLAYER);}catch(e){return structuredClone(DEFAULT_PLAYER);} }
function resetPlayer(){ if(confirm('Reset save? This will clear progress.')){ player=structuredClone(DEFAULT_PLAYER); savePlayer(); location.reload(); } }
function gainXP(amount){
  player.xp += amount;
  while(player.xp >= 100){ player.level++; player.xp -= 100; alert(`You leveled up! Now Level ${player.level}`);}
  savePlayer();
}
function updateUI(){
  document.getElementById('player-info').innerText=`Level: ${player.level} | XP: ${player.xp} | Money: $${player.money} | Bank: $${player.bank}`;
  updateInventoryUI();
  updateTradeUI();
}

// ------------------ Save/Reset ------------------
document.getElementById('save-manual').addEventListener('click', ()=>{ savePlayer(); alert('Saved.'); });
document.getElementById('reset-game').addEventListener('click', resetPlayer);

// ------------------ Bank ------------------
const bankActions=document.getElementById('bank-actions');
bankActions.addEventListener('change',()=>{
  const v=bankActions.value;
  if(v==='deposit10' && player.money>=10){player.money-=10; player.bank+=10;}
  else if(v==='deposit20' && player.money>=20){player.money-=20; player.bank+=20;}
  else if(v==='deposit50' && player.money>=50){player.money-=50; player.bank+=50;}
  else if(v==='depositAll'){player.bank+=player.money; player.money=0;}
  else if(v==='withdraw10' && player.bank>=10){player.bank-=10; player.money+=10;}
  else if(v==='withdraw20' && player.bank>=20){player.bank-=20; player.money+=20;}
  else if(v==='withdraw50' && player.bank>=50){player.bank-=50; player.money+=50;}
  else if(v==='withdrawAll'){player.money+=player.bank; player.bank=0;}
  bankActions.value='';
  savePlayer();
});

// ------------------ Tabs ------------------
const tabButtons = document.querySelectorAll('nav .tab-btn');
const tabs = document.querySelectorAll('main .tab');

function showTab(targetId) {
    tabs.forEach(tab => { tab.style.display = (tab.id === targetId) ? 'block' : 'none'; });
    tabButtons.forEach(btn => { btn.classList.toggle('active', btn.dataset.target === targetId); });
}

// Initialize tabs
tabs.forEach(tab => tab.style.display='none');
showTab('home');

// Click events
tabButtons.forEach(btn => { btn.addEventListener('click', ()=>showTab(btn.dataset.target)); });

// ------------------ Inventory ------------------
function updateInventoryUI(){
  const invPanel=document.getElementById('inventory-list');
  invPanel.innerHTML='';
  for(const [item,qty] of Object.entries(player.inventory)){
    const node=document.createElement('div');
    node.textContent=`${item} x${qty}`;
    invPanel.appendChild(node);
  }
}

// ------------------ Pokémon Data ------------------
const pokemonData=[
  {"id":1,"name":"Bulbasaur"},{"id":2,"name":"Ivysaur"},{"id":3,"name":"Venusaur"},
  {"id":4,"name":"Charmander"},{"id":5,"name":"Charmeleon"},{"id":6,"name":"Charizard"},
  {"id":7,"name":"Squirtle"},{"id":8,"name":"Wartortle"},{"id":9,"name":"Blastoise"},
  {"id":10,"name":"Caterpie"},{"id":11,"name":"Metapod"},{"id":12,"name":"Butterfree"},
  {"id":13,"name":"Weedle"},{"id":14,"name":"Kakuna"},{"id":15,"name":"Beedrill"}
];

// ------------------ Pokedex ------------------
const pokedexBtn=document.getElementById('open-pokedex');
const pokedexListEl=document.getElementById('pokedex-list');
function buildPokedex(){
  pokedexListEl.innerHTML='';
  pokemonData.forEach(p=>{
    const node=document.createElement('div'); node.tabIndex=0;
    node.style.padding='6px 4px'; node.style.borderBottom='1px solid #eee';
    node.setAttribute('role','button');
    node.setAttribute('aria-label',p.name);
    node.textContent=`${p.id.toString().padStart(3,'0')} — ${p.name}`;
    pokedexListEl.appendChild(node);
  });
}
pokedexBtn.addEventListener('click', ()=>{
  const visible=pokedexListEl.style.display==='block';
  if(!visible){ buildPokedex(); pokedexListEl.style.display='block'; pokedexBtn.innerText='Close Pokedex'; pokedexBtn.setAttribute('aria-expanded','true'); }
  else{ pokedexListEl.style.display='none'; pokedexBtn.innerText='Open Pokedex'; pokedexBtn.setAttribute('aria-expanded','false'); }
});

// ------------------ Explore ------------------
const exploreLog=document.getElementById('explore-log');
document.getElementById('catch-pokemon').addEventListener('click',()=>{
  const wild=pokemonData[Math.floor(Math.random()*pokemonData.length)];
  exploreLog.innerText=`A wild ${wild.name} appeared!`;
  setTimeout(()=>{
    const success=Math.random()<0.7;
    if(success){ player.pokemon.push(wild.name); gainXP(20); savePlayer(); exploreLog.innerText=`You caught ${wild.name}! (+20 XP)`;}
    else exploreLog.innerText=`${wild.name} escaped!`;
  },500);
});

// ------------------ Gather ------------------
const gatherLog=document.getElementById('gather-log');
const resources=['Potion','Super Potion','Berry','Shield Vest','Battle Gloves'];
document.getElementById('gather-resource').addEventListener('click',()=>{
  const item=resources[Math.floor(Math.random()*resources.length)];
  player.inventory[item]=(player.inventory[item]||0)+1;
  gatherLog.innerText=`You gathered 1 ${item}. (+10 XP)`;
  gainXP(10);
  savePlayer();
});

// ------------------ Trade ------------------
const tradeMode=document.getElementById('trade-mode');
const tradePanel=document.getElementById('trade-panel');
document.getElementById('sell-all-top').addEventListener('click',()=>{
  let total=0;
  for(const [item,qty] of Object.entries(player.inventory)){
    if(qty>0){ total+=qty*10; player.inventory[item]=0; } // sell price = $10/item
  }
  if(total>0){ player.money+=total; tradePanel.innerText=`Sold all items for $${total}.`; }
  else tradePanel.innerText='No items to sell.';
  savePlayer();
});
function updateTradeUI(){
  tradePanel.innerHTML='';
  const mode=tradeMode.value;
  if(mode==='buy'){
    tradePanel.innerHTML='Available to buy: Potion ($10), Super Potion ($20), Berry ($5)';
  }else{
    const sellable=Object.entries(player.inventory).filter(([k,v])=>v>0);
    if(sellable.length>0){ sellable.forEach(([k,v])=>{const div=document.createElement('div'); div.textContent=`${k} x${v}`; tradePanel.appendChild(div); }); }
    else tradePanel.innerText='No items to sell.';
  }
}
tradeMode.addEventListener('change',updateTradeUI);
updateTradeUI();

// ------------------ Battle ------------------
const battleArea=document.getElementById('battle-area');
const battleStats=document.getElementById('battle-stats');
const moveButtons=document.getElementById('move-buttons');
const battleLog=document.getElementById('battle-log');
document.getElementById('start-battle').addEventListener('click',()=>{
  if(player.pokemon.length===0){ battleLog.innerText='No Pokémon to battle.'; return; }
  battleArea.style.display='block';
  const enemy={name:'Wild Rattata',hp:50};
  const playerMon={name:player.pokemon[0],hp:50};
  battleStats.innerText=`Your ${playerMon.name}: ${playerMon.hp} HP\nEnemy ${enemy.name}: ${enemy.hp} HP`;
  moveButtons.innerHTML='';
  ['Tackle','Growl','Quick Attack','Tail Whip'].forEach(move=>{
    const btn=document.createElement('button'); btn.className='btn alt'; btn.innerText=move;
    btn.addEventListener('click',()=>{
      if(enemy.hp<=0){ battleLog.innerText='Enemy already defeated!'; return; }
      const dmg=Math.floor(Math.random()*15)+5;
      enemy.hp-=dmg;
      if(enemy.hp<0) enemy.hp=0;
      battleStats.innerText=`Your ${playerMon.name}: ${playerMon.hp} HP\nEnemy ${enemy.name}: ${enemy.hp} HP`;
      battleLog.innerText=`You used ${move} and dealt ${dmg} damage!`;
      if(enemy.hp===0){ gainXP(50); battleLog.innerText+=`\nEnemy defeated! (+50 XP)`; savePlayer(); }
    });
    moveButtons.appendChild(btn);
  });
});

updateUI();
</script>
</body>
</html>