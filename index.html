<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Pokémon Adventure</title>
<meta name="theme-color" content="#ef5350" />
<style>
:root{
  --bg:#f5f5f5; --card:#ffffff; --ink:#222; --muted:#666;
  --brand:#ef5350; --brand-ink:#fff; --tab:#fff; --tab-sel:#e0e0e0;
}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--ink)}
h1,h2,h3{margin:.4rem 0}
main{padding:16px 16px 86px}
.card{background:var(--card);border-radius:14px;box-shadow:0 1px 4px rgba(0,0,0,.08);padding:14px;margin-bottom:12px}
button{cursor:pointer;border:0;border-radius:10px;background:var(--brand);color:var(--brand-ink);padding:10px 14px;font-size:16px}
button.secondary{background:#e0e0e0;color:#111}
button.link{background:transparent;color:var(--brand);padding:0}
input,select{width:100%;padding:10px;border:1px solid #ddd;border-radius:10px;margin:6px 0}
.row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.grow{flex:1}
.muted{color:var(--muted)}
.tabs{position:fixed;inset:auto 0 0 0;display:flex;border-top:1px solid #ddd;background:var(--tab);z-index:50}
.tab{flex:1;padding:12px 6px;text-align:center;user-select:none;cursor:pointer}
.tab[aria-selected="true"]{background:var(--tab-sel);font-weight:600}
.panel{display:none}
.panel.active{display:block}
.pill{display:inline-block;background:#ffe0e0;color:#b71c1c;border-radius:999px;padding:2px 10px;font-size:12px;margin-left:6px}
/* Modal */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:1000}
.modal{background:#fff;border-radius:14px;max-width:420px;width:92%;padding:16px;outline:0}
.modal header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.sr-only{position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden}
</style>
</head>
<body>
<main>
  <!-- HOME -->
  <section id="home" class="panel active" aria-labelledby="tab-home">
    <div class="card">
      <h2>Welcome to Pokémon Adventure</h2>
      <p class="muted">Sign up or log in to save your Pokémon and items.</p>
      <div class="row">
        <button id="btn-open-auth-signup">Sign Up</button>
        <button class="secondary" id="btn-open-auth-login">Log In</button>
        <button class="secondary" id="btn-open-auth-google">Sign in with Google</button>
      </div>
      <div id="auth-status" class="muted" aria-live="polite"></div>
    </div>
    <div class="card">
      <h3>Your Trainer</h3>
      <div class="row">
        <div class="grow">
          <div><strong>Level:</strong> <span id="trainer-level">1</span></div>
          <div><strong>XP:</strong> <span id="trainer-xp">0</span> / <span id="trainer-xp-next">100</span></div>
        </div>
        <div><strong>₽</strong> <span id="wallet">500</span></div>
      </div>
    </div>
  </section>

  <!-- EXPLORE -->
  <section id="explore" class="panel" aria-labelledby="tab-explore">
    <div class="card">
      <h2>Explore</h2>
      <p class="muted">Search for wild Pokémon or Gather to gain XP.</p>
      <div class="row">
        <button id="btn-encounter">Find Wild Pokémon</button>
        <button class="secondary" id="btn-gather">Gather</button>
      </div>
      <div id="explore-log" aria-live="polite"></div>
    </div>
    <div class="card" id="encounter-card">
      <h3>Wild Encounter</h3>
      <p><strong id="wild-name">???</strong> <span class="muted" id="wild-id"></span></p>
      <div class="row">
        <button id="btn-throw-ball">Throw Poké Ball</button>
        <button class="secondary" id="btn-run">Run</button>
      </div>
      <div id="encounter-msg" class="muted" aria-live="polite"></div>
    </div>
  </section>

  <!-- INVENTORY -->
  <section id="inventory" class="panel" aria-labelledby="tab-inventory">
    <div class="card">
      <h2>Your Pokémon</h2>
      <div id="my-pokemon"></div>
    </div>
    <div class="card">
      <h2>Your Items</h2>
      <div id="my-items"></div>
    </div>
  </section>

  <!-- POKÉMARKET -->
  <section id="market" class="panel" aria-labelledby="tab-market">
    <div class="card">
      <h2>PokéMarket <span class="pill">New</span></h2>
      <p class="muted">Buy essentials or sell your extras. Sounds play on purchase/sale.</p>
      <div class="row">
        <button id="btn-open-buy">Buy Items</button>
        <button class="secondary" id="btn-open-sell">Sell Items</button>
      </div>
      <p class="muted">Wallet: <strong>₽</strong> <span id="market-wallet">0</span></p>
    </div>
  </section>

  <!-- PLACEHOLDER PANELS -->
  <section id="battle" class="panel" aria-labelledby="tab-battle">
    <div class="card"><h2>Battle</h2><p class="muted">Turn-based battle with move selection coming next.</p></div>
  </section>
  <section id="trade" class="panel" aria-labelledby="tab-trade">
    <div class="card"><h2>Trade</h2><p class="muted">6-digit friend code trading coming next.</p></div>
  </section>
  <section id="center" class="panel" aria-labelledby="tab-center">
    <div class="card"><h2>PokéCenter</h2><p class="muted">Rest and heal coming next.</p></div>
  </section>
</main>

<!-- TABS -->
<nav class="tabs" role="tablist" aria-label="Main tabs">
  <div id="tab-home" class="tab" role="tab" aria-controls="home" aria-selected="true" tabindex="0">Home</div>
  <div id="tab-explore" class="tab" role="tab" aria-controls="explore" aria-selected="false" tabindex="0">Explore</div>
  <div id="tab-inventory" class="tab" role="tab" aria-controls="inventory" aria-selected="false" tabindex="0">Inventory</div>
  <div id="tab-market" class="tab" role="tab" aria-controls="market" aria-selected="false" tabindex="0">PokéMarket</div>
  <div id="tab-battle" class="tab" role="tab" aria-controls="battle" aria-selected="false" tabindex="0">Battle</div>
  <div id="tab-trade" class="tab" role="tab" aria-controls="trade" aria-selected="false" tabindex="0">Trade</div>
  <div id="tab-center" class="tab" role="tab" aria-controls="center" aria-selected="false" tabindex="0">PokéCenter</div>
</nav>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.25.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.25.0/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/9.25.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDB4XhURDerrLIfb_PdcyDHiBhyzIqRxvY",
  authDomain: "pokemon-756e7.firebaseapp.com",
  projectId: "pokemon-756e7",
  storageBucket: "pokemon-756e7.appspot.com",
  messagingSenderId: "799827870179",
  appId: "1:799827870179:web:7cf9995a4c45469b02e0d6"
};
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

/* =========================
   Tabs
========================= */
document.addEventListener('DOMContentLoaded', ()=>{
  const panels = [...document.querySelectorAll('.panel')];
  document.querySelectorAll('.tab').forEach(t=>{
    t.addEventListener('click', ()=>{
      document.querySelectorAll('.tab').forEach(x=>x.setAttribute('aria-selected','false'));
      t.setAttribute('aria-selected','true');
      panels.forEach(p=>p.classList.remove('active'));
      const target = document.getElementById(t.getAttribute('aria-controls'));
      if(target) target.classList.add('active');
    });
    t.addEventListener('keydown', (e)=>{
      if(e.key === "Enter" || e.key === " "){ t.click(); e.preventDefault(); }
    });
  });
});
</script>
</body>
</html>