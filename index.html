<!DOCTYPE html>
<html>
<head>
  <title>Madden Style Football</title>
  <style>
    button { display:block; margin:10px; font-size:18px; }
  </style>
</head>
<body>
  <h1>Madden Style Football</h1>

  <!-- Main Menu -->
  <div id="menu" role="navigation" aria-label="Main Menu">
    <button onclick="startQuickPlay()" aria-label="Start Quick Play">Quick Play</button>
    <button onclick="startFranchise()" aria-label="Start Franchise Mode">Franchise</button>
  </div>

  <!-- Game Screen -->
  <div id="game" style="display:none;">
    <div id="scoreboard" aria-live="polite"></div>
    <div id="situation" aria-live="polite"></div>

    <!-- Offensive Playbook -->
    <div id="offensePlays" style="display:none;" aria-label="Offensive Playbook">
      <h3>Offensive Playbook</h3>
      <button onclick="callPlay('run')" aria-label="Run Play">Run Play</button>
      <button onclick="callPlay('shortPass')" aria-label="Short Pass Play">Short Pass</button>
      <button onclick="callPlay('longPass')" aria-label="Long Pass Play">Long Pass</button>
    </div>

    <!-- Defensive Playbook -->
    <div id="defensePlays" style="display:none;" aria-label="Defensive Playbook">
      <h3>Defensive Playbook</h3>
      <button onclick="chooseDefense('blitz')" aria-label="Blitz Defense">Blitz</button>
      <button onclick="chooseDefense('zone')" aria-label="Zone Defense">Zone</button>
      <button onclick="chooseDefense('man')" aria-label="Man Coverage Defense">Man Coverage</button>
    </div>

    <!-- Fourth Down Options -->
    <div id="fourthDownOptions" style="display:none;" aria-label="Fourth Down Options">
      <h3>Fourth Down Options</h3>
      <button onclick="fieldGoal()" aria-label="Kick Field Goal">Kick Field Goal</button>
      <button onclick="punt()" aria-label="Punt Ball">Punt</button>
      <button onclick="callPlay('goForIt')" aria-label="Go For It on Fourth Down">Go For It</button>
    </div>

    <button onclick="nextQuarter()" aria-label="Next Quarter">Next Quarter</button>
  </div>

  <script>
    let homeTeam = "Cowboys";
    let awayTeam = "Eagles";
    let homeScore = 0;
    let awayScore = 0;
    let possession = "home";
    let currentDown = 1;
    let yardsToFirst = 10;
    let ballPosition = 25;
    let quarter = 1;
    let defenseChoice = "zone";

    function announce(message) {
      const liveRegion = document.getElementById('situation');
      liveRegion.innerText = message; // TalkBack will read this
      // Show offensive plays again automatically
      document.getElementById('offensePlays').style.display = 'block';
      document.getElementById('fourthDownOptions').style.display = 'none';
    }

    function startQuickPlay() {
      document.getElementById('menu').style.display = 'none';
      document.getElementById('game').style.display = 'block';
      announce("Quick Play starting");
      updateSituation();
      document.getElementById('offensePlays').style.display = 'block';
    }

    function startFranchise() {
      announce("Franchise Mode coming soon!");
    }

    function updateSituation() {
      let teamWithBall = (possession === "home") ? homeTeam : awayTeam;
      document.getElementById('scoreboard').innerText = `${homeTeam} ${homeScore} - ${awayScore} ${awayTeam}`;
      document.getElementById('situation').innerText =
        `${currentDown} and ${yardsToFirst} at the ${ballPosition} yard line. ${teamWithBall} ball.`;

      if (currentDown === 4 && yardsToFirst > 0) {
        document.getElementById('offensePlays').style.display = 'none';
        document.getElementById('fourthDownOptions').style.display = 'block';
      } else {
        document.getElementById('offensePlays').style.display = 'block';
        document.getElementById('fourthDownOptions').style.display = 'none';
      }
    }

    function chooseDefense(choice) {
      defenseChoice = choice;
      announce(`Defense sets ${choice}`);
    }

    function callPlay(playType) {
      let yards = 0;
      let defense = defenseChoice;

      if (playType === 'run') {
        yards = Math.floor(Math.random() * 3) + 2; 
        if (defense === "blitz") yards -= 1;
      } else if (playType === 'shortPass') {
        yards = Math.floor(Math.random() * 6) + 10; 
        if (defense === "zone") yards -= 5;
      } else if (playType === 'longPass') {
        yards = Math.floor(Math.random() * 11) + 30; 
        if (defense === "man") yards -= 10;
      } else if (playType === 'goForIt') {
        yards = Math.floor(Math.random() * 10) + 1;
      }

      if (yards < 0) yards = 0;

      ballPosition += yards;
      yardsToFirst -= yards;

      let msg = `${(possession === "home" ? homeTeam : awayTeam)} gained ${yards} yards. `;

      if (ballPosition >= 100) {
        msg += "Touchdown!";
        if (possession === "home") homeScore += 7; else awayScore += 7;
        changePossession(true); 
      } else if (yardsToFirst <= 0) {
        currentDown = 1;
        yardsToFirst = 10;
        msg += "First down!";
      } else {
        currentDown++;
        if (currentDown > 4) {
          msg += "Turnover on downs.";
          changePossession();
        }
      }

      updateSituation();
      announce(msg); // Live region instead of alert
    }

    function punt() {
      let puntYards = Math.floor(Math.random() * 20) + 40;
      ballPosition = 100 - puntYards;
      changePossession();
      let teamWithBall = (possession === "home") ? homeTeam : awayTeam;
      announce(`Punt goes ${puntYards} yards. ${teamWithBall} takes over.`);
      updateSituation();
    }

    function fieldGoal() {
      if (ballPosition >= 60) {
        announce("Field goal is good!");
        if (possession === "home") homeScore += 3; else awayScore += 3;
      } else {
        announce("Field goal is no good.");
      }
      changePossession(true);
      updateSituation();
    }

    function changePossession(reset=false) {
      possession = (possession === "home") ? "away" : "home";
      currentDown = 1;
      yardsToFirst = 10;
      ballPosition = reset ? 25 : 100 - ballPosition;
    }

    function nextQuarter() {
      quarter++;
      if (quarter === 3) {
        announce("Halftime show starting!");
      } else if (quarter > 4) {
        announce("Game Over! Final score " +
          `${homeTeam} ${homeScore}, ${awayTeam} ${awayScore}`);
      } else {
        announce(`Starting Quarter ${quarter}`);
      }
    }
  </script>
</body>
</html>