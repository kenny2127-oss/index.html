<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Madden Style Football (Accessible)</title>
<style>
  :root { font-size: 18px; }
  body { font-family: system-ui, -apple-system, Arial, sans-serif; line-height: 1.4; padding: 12px; }
  button, select { display:block; margin:10px 0; font-size:1rem; padding:10px; }
  #game, #teamSelection { display:none; }
  #aiAnnounce { position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden; }
  #scoreboard, #situation, #quarterClock { margin:8px 0; }
  h1, h3 { margin:8px 0; }
  .group { margin:14px 0; }
</style>
</head>
<body>
<h1>Accessible Football</h1>

<!-- Main Menu -->
<div id="menu" role="navigation" aria-label="Main Menu">
  <button id="quickPlayBtn" aria-label="Start Quick Play">Quick Play</button>
  <button id="franchiseBtn" aria-label="Start Franchise Mode">Franchise</button>
</div>

<!-- Team Selection -->
<div id="teamSelection" aria-label="Team Selection">
  <h3>Select Teams</h3>
  <label for="homeTeamSelect">Home Team:</label>
  <select id="homeTeamSelect">
    <!-- NFC West -->
    <option value="49ers" selected>49ers</option>
    <option value="Seahawks">Seahawks</option>
    <option value="Rams">Rams</option>
    <option value="Cardinals">Cardinals</option>
    <!-- NFC East -->
    <option value="Cowboys">Cowboys</option>
    <option value="Eagles">Eagles</option>
    <option value="Giants">Giants</option>
    <option value="Commanders">Commanders</option>
    <!-- NFC North -->
    <option value="Lions">Lions</option>
    <option value="Packers">Packers</option>
    <option value="Vikings">Vikings</option>
    <option value="Bears">Bears</option>
    <!-- NFC South -->
    <option value="Buccaneers">Buccaneers</option>
    <option value="Saints">Saints</option>
    <option value="Falcons">Falcons</option>
    <option value="Panthers">Panthers</option>
    <!-- AFC West -->
    <option value="Chiefs">Chiefs</option>
    <option value="Chargers">Chargers</option>
    <option value="Raiders">Raiders</option>
    <option value="Broncos">Broncos</option>
    <!-- AFC East -->
    <option value="Bills">Bills</option>
    <option value="Dolphins">Dolphins</option>
    <option value="Patriots">Patriots</option>
    <option value="Jets">Jets</option>
    <!-- AFC North -->
    <option value="Ravens">Ravens</option>
    <option value="Bengals">Bengals</option>
    <option value="Browns">Browns</option>
    <option value="Steelers">Steelers</option>
    <!-- AFC South -->
    <option value="Jaguars">Jaguars</option>
    <option value="Titans">Titans</option>
    <option value="Colts">Colts</option>
    <option value="Texans">Texans</option>
  </select>

  <label for="awayTeamSelect">Away Team:</label>
  <select id="awayTeamSelect" aria-label="Choose Away Team">
    <!-- Same 32 teams -->
    <option value="49ers">49ers</option>
    <option value="Seahawks">Seahawks</option>
    <option value="Rams">Rams</option>
    <option value="Cardinals">Cardinals</option>
    <option value="Cowboys">Cowboys</option>
    <option value="Eagles">Eagles</option>
    <option value="Giants">Giants</option>
    <option value="Commanders">Commanders</option>
    <option value="Lions">Lions</option>
    <option value="Packers">Packers</option>
    <option value="Vikings">Vikings</option>
    <option value="Bears">Bears</option>
    <option value="Buccaneers">Buccaneers</option>
    <option value="Saints">Saints</option>
    <option value="Falcons">Falcons</option>
    <option value="Panthers">Panthers</option>
    <option value="Chiefs">Chiefs</option>
    <option value="Chargers">Chargers</option>
    <option value="Raiders">Raiders</option>
    <option value="Broncos">Broncos</option>
    <option value="Bills">Bills</option>
    <option value="Dolphins">Dolphins</option>
    <option value="Patriots">Patriots</option>
    <option value="Jets">Jets</option>
    <option value="Ravens">Ravens</option>
    <option value="Bengals">Bengals</option>
    <option value="Browns">Browns</option>
    <option value="Steelers">Steelers</option>
    <option value="Jaguars">Jaguars</option>
    <option value="Titans">Titans</option>
    <option value="Colts">Colts</option>
    <option value="Texans">Texans</option>
  </select>

  <button id="startGameBtn" aria-label="Start Game">Start Game</button>
</div>

<!-- Game Screen -->
<div id="game" aria-live="off">
  <div id="scoreboard" aria-live="polite"></div>
  <div id="situation" aria-live="polite"></div>
  <div id="quarterClock" aria-live="polite"></div>
  <div id="aiAnnounce" aria-live="polite"></div>

  <div id="offensePlays" class="group" aria-label="Offensive Playbook">
    <h3>Offensive Playbook</h3>
    <button id="runPlayBtn" aria-label="Run Play">Run Play</button>
    <button id="shortPassBtn" aria-label="Short Pass Play">Short Pass</button>
    <button id="longPassBtn" aria-label="Long Pass Play">Long Pass</button>
    <button id="drawBtn" aria-label="Draw Play">Draw</button>
    <button id="playActionBtn" aria-label="Play Action Pass">Play Action</button>
  </div>

  <div id="defensePlays" class="group" aria-label="Defensive Playbook">
    <h3>Defensive Playbook (sets AI difficulty)</h3>
    <button id="blitzBtn" aria-label="Blitz Defense">Blitz</button>
    <button id="zoneBtn" aria-label="Zone Defense">Zone</button>
    <button id="manBtn" aria-label="Man Coverage Defense">Man Coverage</button>
    <button id="preventBtn" aria-label="Prevent Defense">Prevent</button>
  </div>

  <div id="fourthDownOptions" class="group" aria-label="Fourth Down Options">
    <h3>Fourth Down Options</h3>
    <button id="fieldGoalBtn" aria-label="Kick Field Goal">Kick Field Goal</button>
    <button id="puntBtn" aria-label="Punt Ball">Punt</button>
    <button id="goForItBtn" aria-label="Go For It on Fourth Down">Go For It</button>
  </div>
</div>

<script>
window.onload = function(){
  // ---- State ----
  let homeTeam="49ers", awayTeam="Eagles", homeScore=0, awayScore=0;
  let lastAnnouncedHomeScore=0, lastAnnouncedAwayScore=0;
  let possession="home", currentDown=1, yardsToFirst=10, ballPosition=25, quarter=1;
  let defenseChoice="zone", quarterTime=15*60, quarterInterval=null;
  let weather="Clear";
  let userInteracted=false;

  // ---- Sound effects ----
  const sounds={
    whistle:"https://cdn.pixabay.com/download/audio/2023/03/20/audio_d1f019a63f.mp3?filename=whistle-6287.mp3",
    crowdFirstDown:"https://cdn.pixabay.com/download/audio/2023/03/20/audio_6b2f015d13.mp3?filename=crowd-cheer-1st-down-6290.mp3",
    crowdTD:"https://cdn.pixabay.com/download/audio/2023/03/20/audio_1c0d7dbde4.mp3?filename=crowd-cheer-touchdown-6291.mp3",
    tackle:"https://cdn.pixabay.com/download/audio/2023/03/20/audio_9a8b4b6c48.mp3?filename=tackle-6288.mp3",
    kick:"https://cdn.pixabay.com/download/audio/2023/03/20/audio_4ef9f3e3f0.mp3?filename=kick-6289.mp3"
  };
  const audio={};
  for (const k in sounds){ audio[k]=new Audio(sounds[k]); audio[k].preload="auto"; }

  function playSound(key){
    try{ audio[key].currentTime=0; audio[key].play(); }catch(e){}
  }

  // ---- Roster pools (compact; randomized each play) ----
  // Each team: { qb:[], rb:[], wr:[], te:[], def:[] }
  // (These are representative player pools to keep the file size reasonable.)
  const rosters = {
    "49ers": {
      qb:["Brock Purdy"],
      rb:["Christian McCaffrey","Elijah Mitchell","Jordan Mason"],
      wr:["Deebo Samuel","Brandon Aiyuk","Jauan Jennings","Ricky Pearsall"],
      te:["George Kittle"],
      def:["Nick Bosa","Fred Warner","Javon Hargrave","Dre Greenlaw","Charvarius Ward"]
    },
    "Seahawks": {
      qb:["Geno Smith"],
      rb:["Kenneth Walker III","Zach Charbonnet"],
      wr:["DK Metcalf","Tyler Lockett","Jaxon Smith-Njigba"],
      te:["Noah Fant"],
      def:["Boye Mafe","Riq Woolen","Devon Witherspoon","Julian Love"]
    },
    "Rams": {
      qb:["Matthew Stafford"],
      rb:["Kyren Williams"],
      wr:["Cooper Kupp","Puka Nacua","Demarcus Robinson"],
      te:["Tyler Higbee"],
      def:["Aaron Donald","Ernest Jones","Kobie Turner","Byron Young"]
    },
    "Cardinals": {
      qb:["Kyler Murray"],
      rb:["James Conner"],
      wr:["Marvin Harrison Jr.","Michael Wilson"],
      te:["Trey McBride"],
      def:["Budda Baker","Zaven Collins","BJ Ojulari"]
    },
    "Cowboys": {
      qb:["Dak Prescott"],
      rb:["Tony Pollard","Rico Dowdle"],
      wr:["CeeDee Lamb","Brandin Cooks","Jalen Tolbert"],
      te:["Jake Ferguson"],
      def:["Micah Parsons","Trevon Diggs","DeMarcus Lawrence"]
    },
    "Eagles": {
      qb:["Jalen Hurts"],
      rb:["Saquon Barkley"],
      wr:["A.J. Brown","DeVonta Smith"],
      te:["Dallas Goedert"],
      def:["Haason Reddick","Darius Slay","Jordan Davis"]
    },
    "Giants": {
      qb:["Daniel Jones"],
      rb:["Devin Singletary"],
      wr:["Malik Nabers","Darius Slayton"],
      te:["Darren Waller","Daniel Bellinger"],
      def:["Dexter Lawrence","Kayvon Thibodeaux","Bobby Okereke"]
    },
    "Commanders": {
      qb:["Jayden Daniels","Marcus Mariota"],
      rb:["Brian Robinson Jr.","Austin Ekeler"],
      wr:["Terry McLaurin","Jahan Dotson"],
      te:["Zach Ertz"],
      def:["Jonathan Allen","Daron Payne","Jamin Davis"]
    },
    "Lions": {
      qb:["Jared Goff"],
      rb:["Jahmyr Gibbs","David Montgomery"],
      wr:["Amon-Ra St. Brown","Jameson Williams"],
      te:["Sam LaPorta"],
      def:["Aidan Hutchinson","Brian Branch","Alim McNeill"]
    },
    "Packers": {
      qb:["Jordan Love"],
      rb:["Josh Jacobs","AJ Dillon"],
      wr:["Christian Watson","Romeo Doubs","Jayden Reed"],
      te:["Luke Musgrave","Tucker Kraft"],
      def:["Jaire Alexander","Rashan Gary","Quay Walker"]
    },
    "Vikings": {
      qb:["J.J. McCarthy","Sam Darnold"],
      rb:["Aaron Jones","Ty Chandler"],
      wr:["Justin Jefferson","Jordan Addison"],
      te:["T.J. Hockenson"],
      def:["Danielle Hunter","Harrison Smith","Byron Murphy Jr."]
    },
    "Bears": {
      qb:["Caleb Williams"],
      rb:["D'Andre Swift","Khalil Herbert"],
      wr:["DJ Moore","Keenan Allen","Rome Odunze"],
      te:["Cole Kmet"],
      def:["Montez Sweat","Tremaine Edmunds","Jaylon Johnson"]
    },
    "Buccaneers": {
      qb:["Baker Mayfield"],
      rb:["Rachaad White"],
      wr:["Mike Evans","Chris Godwin"],
      te:["Cade Otton"],
      def:["Vita Vea","Lavonte David","Antoine Winfield Jr."]
    },
    "Saints": {
      qb:["Derek Carr"],
      rb:["Alvin Kamara","Jamaal Williams"],
      wr:["Chris Olave","Rashid Shaheed"],
      te:["Juwan Johnson"],
      def:["Cameron Jordan","Demario Davis","Tyrann Mathieu"]
    },
    "Falcons": {
      qb:["Kirk Cousins","Michael Penix Jr."],
      rb:["Bijan Robinson","Tyler Allgeier"],
      wr:["Drake London","Darnell Mooney"],
      te:["Kyle Pitts"],
      def:["A.J. Terrell","Grady Jarrett","Kaden Elliss"]
    },
    "Panthers": {
      qb:["Bryce Young"],
      rb:["Chuba Hubbard","Miles Sanders"],
      wr:["Adam Thielen","Diontae Johnson","Xavier Legette"],
      te:["Tommy Tremble"],
      def:["Brian Burns","Derrick Brown","Jaycee Horn"]
    },
    "Chiefs": {
      qb:["Patrick Mahomes"],
      rb:["Isiah Pacheco"],
      wr:["Rashee Rice","Marquise Brown","Xavier Worthy"],
      te:["Travis Kelce"],
      def:["Chris Jones","Nick Bolton","L'Jarius Sneed"]
    },
    "Chargers": {
      qb:["Justin Herbert"],
      rb:["Gus Edwards","J.K. Dobbins"],
      wr:["Keenan Allen","Joshua Palmer","Quentin Johnston"],
      te:["Will Dissly"],
      def:["Derwin James Jr.","Joey Bosa","Khalil Mack"]
    },
    "Raiders": {
      qb:["Aidan O'Connell","Gardner Minshew"],
      rb:["Zamir White"],
      wr:["Davante Adams","Jakobi Meyers"],
      te:["Michael Mayer","Brock Bowers"],
      def:["Maxx Crosby","Robert Spillane","Nate Hobbs"]
    },
    "Broncos": {
      qb:["Bo Nix","Zach Wilson","Jarrett Stidham"],
      rb:["Javonte Williams","Samaje Perine"],
      wr:["Courtland Sutton","Jerry Jeudy","Marvin Mims Jr."],
      te:["Greg Dulcich"],
      def:["Pat Surtain II","Justin Simmons","Zach Allen"]
    },
    "Bills": {
      qb:["Josh Allen"],
      rb:["James Cook"],
      wr:["Stefon Diggs","Khalil Shakir","Curtis Samuel"],
      te:["Dalton Kincaid","Dawson Knox"],
      def:["Matt Milano","Ed Oliver","Rasul Douglas"]
    },
    "Dolphins": {
      qb:["Tua Tagovailoa"],
      rb:["Raheem Mostert","De'Von Achane"],
      wr:["Tyreek Hill","Jaylen Waddle"],
      te:["Jonnu Smith"],
      def:["Jalen Ramsey","Jaelan Phillips","Bradley Chubb"]
    },
    "Patriots": {
      qb:["Drake Maye","Jacoby Brissett"],
      rb:["Rhamondre Stevenson"],
      wr:["Kendrick Bourne","Jalen Reagor","Ja'Lynn Polk"],
      te:["Hunter Henry"],
      def:["Matthew Judon","Kyle Dugger","Christian Gonzalez"]
    },
    "Jets": {
      qb:["Aaron Rodgers"],
      rb:["Breece Hall"],
      wr:["Garrett Wilson","Mike Williams"],
      te:["Tyler Conklin"],
      def:["Sauce Gardner","Quinnen Williams","C.J. Mosley"]
    },
    "Ravens": {
      qb:["Lamar Jackson"],
      rb:["Derrick Henry","Keaton Mitchell"],
      wr:["Zay Flowers","Rashod Bateman"],
      te:["Mark Andrews","Isaiah Likely"],
      def:["Roquan Smith","Kyle Hamilton","Justin Madubuike"]
    },
    "Bengals": {
      qb:["Joe Burrow"],
      rb:["Joe Mixon","Zack Moss"],
      wr:["Ja'Marr Chase","Tee Higgins","Tyler Boyd"],
      te:["Mike Gesicki"],
      def:["Trey Hendrickson","Logan Wilson","Dax Hill"]
    },
    "Browns": {
      qb:["Deshaun Watson"],
      rb:["Nick Chubb","Jerome Ford"],
      wr:["Amari Cooper","Jerry Jeudy","Elijah Moore"],
      te:["David Njoku"],
      def:["Myles Garrett","Denzel Ward","Jeremiah Owusu-Koramoah"]
    },
    "Steelers": {
      qb:["Russell Wilson","Justin Fields"],
      rb:["Najee Harris","Jaylen Warren"],
      wr:["George Pickens","Roman Wilson"],
      te:["Pat Freiermuth"],
      def:["T.J. Watt","Minkah Fitzpatrick","Cameron Heyward"]
    },
    "Jaguars": {
      qb:["Trevor Lawrence"],
      rb:["Travis Etienne Jr."],
      wr:["Christian Kirk","Gabriel Davis"],
      te:["Evan Engram"],
      def:["Josh Allen","Devin Lloyd","Andre Cisco"]
    },
    "Titans": {
      qb:["Will Levis"],
      rb:["Tony Pollard","Tyjae Spears"],
      wr:["DeAndre Hopkins","Calvin Ridley"],
      te:["Chigoziem Okonkwo"],
      def:["Jeffery Simmons","Harold Landry","Kristian Fulton"]
    },
    "Colts": {
      qb:["Anthony Richardson"],
      rb:["Jonathan Taylor"],
      wr:["Michael Pittman Jr.","Josh Downs","Alec Pierce"],
      te:["Jelani Woods"],
      def:["DeForest Buckner","Shaquille Leonard","Kenny Moore II"]
    },
    "Texans": {
      qb:["C.J. Stroud"],
      rb:["Joe Mixon","Dameon Pierce"],
      wr:["Nico Collins","Stefon Diggs","Tank Dell"],
      te:["Dalton Schultz"],
      def:["Will Anderson Jr.","Derek Stingley Jr.","Jimmie Ward"]
    }
  };

  function pick(arr){ return arr[Math.floor(Math.random()*arr.length)] || ""; }

  function getQB(team){ return (rosters[team]?.qb && pick(rosters[team].qb)) || "the quarterback"; }
  function getRB(team){ return (rosters[team]?.rb && pick(rosters[team].rb)) || "the running back"; }
  function getReceiver(team){
    const teamData = rosters[team];
    if(!teamData) return "the receiver";
    const pool = [].concat(teamData.wr||[], teamData.te||[]);
    return pick(pool) || "the receiver";
  }
  function getDefender(team){ return (rosters[team]?.def && pick(rosters[team].def)) || "the defender"; }

  // ---- UI helpers ----
  function announce(text, ai=false){
    const el = ai ? document.getElementById('aiAnnounce') : document.getElementById('situation');
    el.textContent = text;
  }
  function updateScore(announceScore=false){
    const sb = document.getElementById('scoreboard');
    sb.textContent = `${homeTeam} ${homeScore} - ${awayScore} ${awayTeam}`;
    if(announceScore){
      if(homeScore!==lastAnnouncedHomeScore || awayScore!==lastAnnouncedAwayScore){
        announce(`Score update: ${homeTeam} ${homeScore}, ${awayTeam} ${awayScore}`);
        lastAnnouncedHomeScore=homeScore; lastAnnouncedAwayScore=awayScore;
      }
    }
  }
  function updateSituation(){
    const teamWithBall = (possession==="home")?homeTeam:awayTeam;
    document.getElementById('situation').textContent =
      `${currentDown} and ${yardsToFirst} at the ${ballPosition} yard line. ${teamWithBall} ball.`;
  }

  // ---- Flow ----
  function startQuickPlay(){
    document.getElementById('menu').style.display='none';
    document.getElementById('teamSelection').style.display='block';
    announce("Quick Play selected. Choose your home and away teams.");
  }

  function startGame(){
    homeTeam = document.getElementById('homeTeamSelect').value;
    awayTeam = document.getElementById('awayTeamSelect').value;
    homeScore=0; awayScore=0;
    lastAnnouncedHomeScore=0; lastAnnouncedAwayScore=0;
    possession="home"; currentDown=1; yardsToFirst=10; ballPosition=25;
    quarter=1; quarterTime=15*60;

    document.getElementById('teamSelection').style.display='none';
    document.getElementById('game').style.display='block';
    document.getElementById('offensePlays').style.display='block';
    document.getElementById('defensePlays').style.display='none';
    updateScore(false); updateSituation();
    announce(`Game starting. ${homeTeam} vs ${awayTeam}. ${homeTeam} receives and starts at the ${ballPosition}. Weather: ${weather}`);
    startQuarterClock();
    playSound('whistle');
  }

  function startQuarterClock(){
    if(quarterInterval) clearInterval(quarterInterval);
    // announce start of quarter
    announce(`Starting Quarter ${quarter}`);
    quarterInterval = setInterval(()=>{
      quarterTime--;
      const min=Math.floor(quarterTime/60), sec=quarterTime%60;
      document.getElementById('quarterClock').textContent =
        `Quarter ${quarter}, Time Remaining: ${min}:${sec<10?'0'+sec:sec}`;
      if(quarterTime===300 || quarterTime===120 || quarterTime===30){
        // milestone announcements only
        announce(`${min} minutes ${sec===0?'':'and '+sec+' seconds'} remaining in Quarter ${quarter}`);
      }
      if(quarterTime<=0){
        nextQuarter();
      }
    }, 1000);
  }

  function nextQuarter(){
    quarter++;
    if(quarter===3){
      announce("Halftime Show!"); playSound('crowdFirstDown');
      // brief stat note
      announce(`Halftime. Score: ${homeTeam} ${homeScore}, ${awayTeam} ${awayScore}.`);
      quarterTime=15*60;
    } else if(quarter>4){
      clearInterval(quarterInterval);
      announce(`Game Over! Final Score: ${homeTeam} ${homeScore}, ${awayTeam} ${awayScore}.`);
      return;
    } else {
      announce(`Starting Quarter ${quarter}`);
      quarterTime=15*60;
    }
  }

  // ---- Core play simulation ----
  function callPlay(playType, ai=false){
    if(!userInteracted){ userInteracted=true; } // enables audio on mobile after first tap
    // baseline yardages
    let yards=0;
    if(playType==='run'){ yards = Math.floor(Math.random()*2)+2; /* 2-3 */ }
    else if(playType==='shortPass'){ yards = Math.floor(Math.random()*6)+10; /*10-15*/ }
    else if(playType==='longPass'){ yards = Math.floor(Math.random()*11)+30; /*30-40*/ }
    else if(playType==='draw'){ yards = Math.floor(Math.random()*2)+2; }
    else if(playType==='playAction'){ yards = Math.floor(Math.random()*6)+10; }

    // defense effect
    if(defenseChoice==='blitz' && (playType==='run' || playType==='draw')) yards = Math.max(0, yards-1);
    if(defenseChoice==='zone' && (playType==='shortPass' || playType==='playAction')) yards = Math.max(0, yards-3);
    if(defenseChoice==='man' && playType==='longPass') yards = Math.max(0, yards-8);

    // pick players based on team with ball
    const offenseTeam = (possession==="home")?homeTeam:awayTeam;
    const defenseTeam = (possession==="home")?awayTeam:homeTeam;
    const qb = getQB(offenseTeam);
    const rb = getRB(offenseTeam);
    const rec = getReceiver(offenseTeam);
    const tackler = getDefender(defenseTeam);

    let narration="";
    if(playType==='run' || playType==='draw'){
      narration = `${qb} hands to ${rb} for ${yards} yards, tackled by ${tackler}.`;
    } else { // pass
      narration = `${qb} to ${rec} for ${yards} yards, tackled by ${tackler}.`;
    }

    ballPosition += yards;
    yardsToFirst -= yards;

    let msg = `${offenseTeam} gained ${yards} yards. `;
    let scored=false;

    if(ballPosition>=100){
      msg += "Touchdown!";
      scored=true;
      if(possession==="home") homeScore+=7; else awayScore+=7;
      playSound('crowdTD');
      changePossession(true); // reset to 25 for receiving team
    } else if(yardsToFirst<=0){
      currentDown=1; yardsToFirst=10;
      msg += "First down!";
      playSound('crowdFirstDown');
    } else {
      currentDown++;
      if(currentDown>4){
        msg += "Turnover on downs.";
        changePossession();
      }
    }

    // Announce play details + updated situation
    const detail = `${narration} ${msg} Down ${currentDown}, ${yardsToFirst} to go, ball at ${ballPosition}.`;
    announce(detail, ai);
    playSound('tackle');
    updateSituation();
    if(scored) updateScore(true);

    // If AI has ball, keep auto-playing
    if(possession!=="home" && !ai){
      setTimeout(()=>autoPlay(), 900);
    }
  }

  function autoPlay(){
    if(possession==="home") return;
    const plays=['run','shortPass','longPass','draw','playAction'];
    const chosen = plays[Math.floor(Math.random()*plays.length)];
    setTimeout(()=>callPlay(chosen,true), 350);
  }

  function changePossession(reset=false){
    possession = (possession==="home") ? "away" : "home";
    currentDown=1; yardsToFirst=10;
    if(reset){ ballPosition=25; } else { ballPosition = 100 - ballPosition; }
    updateSituation();
    // When AI gains ball, they start calling plays
    if(possession!=="home") autoPlay();
  }

  function punt(){
    const puntYards = Math.floor(Math.random()*20)+40; // 40-59
    ballPosition = Math.max(0, 100 - puntYards);
    playSound('kick');
    changePossession();
    announce(`Punt goes ${puntYards} yards. ${ (possession==="home"?homeTeam:awayTeam) } takes over at the ${ballPosition}.`, true);
  }

  function fieldGoal(){
    // Rough range threshold: if at or inside the 40 (60+ yards from offense endzone)
    if(ballPosition>=60){
      playSound('kick');
      if(possession==="home") homeScore+=3; else awayScore+=3;
      announce("Field goal is good!");
      updateScore(true);
      changePossession(true);
    } else {
      playSound('kick');
      announce("Field goal is no good.");
      changePossession(true);
    }
  }

  function startFranchise(){ announce("Franchise Mode coming soon!"); }

  // ---- Buttons wiring ----
  document.getElementById('quickPlayBtn').onclick = startQuickPlay;
  document.getElementById('franchiseBtn').onclick = startFranchise;
  document.getElementById('startGameBtn').onclick = function(){
    userInteracted=true; // enable audio on mobile after this click
    startGame();
  };

  document.getElementById('runPlayBtn').onclick = ()=>{ playSound('whistle'); callPlay('run'); };
  document.getElementById('shortPassBtn').onclick = ()=>{ playSound('whistle'); callPlay('shortPass'); };
  document.getElementById('longPassBtn').onclick = ()=>{ playSound('whistle'); callPlay('longPass'); };
  document.getElementById('drawBtn').onclick = ()=>{ playSound('whistle'); callPlay('draw'); };
  document.getElementById('playActionBtn').onclick = ()=>{ playSound('whistle'); callPlay('playAction'); };

  document.getElementById('blitzBtn').onclick = ()=>{ defenseChoice='blitz'; announce('Blitz defense set.'); };
  document.getElementById('zoneBtn').onclick = ()=>{ defenseChoice='zone'; announce('Zone defense set.'); };
  document.getElementById('manBtn').onclick = ()=>{ defenseChoice='man'; announce('Man coverage defense set.'); };
  document.getElementById('preventBtn').onclick = ()=>{ defenseChoice='prevent'; announce('Prevent defense set.'); };

  document.getElementById('fieldGoalBtn').onclick = fieldGoal;
  document.getElementById('puntBtn').onclick = punt;
  document.getElementById('goForItBtn').onclick = ()=>{ playSound('whistle'); callPlay('playAction'); }; // treat as aggressive play

  // Initialize visible score/situation for SR
  updateScore(false);
  updateSituation();
};
</script>
</body>
</html>