<!DOCTYPE html>
<html>
<head>
  <title>Madden Style Football</title>
  <style>
    button, select { display:block; margin:10px; font-size:18px; }
  </style>
</head>
<body>
  <h1>Madden Style Football</h1>

  <!-- Main Menu -->
  <div id="menu" role="navigation" aria-label="Main Menu">
    <button id="quickPlayBtn" aria-label="Start Quick Play">Quick Play</button>
    <button id="franchiseBtn" aria-label="Start Franchise Mode">Franchise</button>
  </div>

  <!-- Quick Play Team Selection -->
  <div id="teamSelection" style="display:none;" aria-label="Team Selection">
    <h3>Select Teams</h3>
    <label for="homeTeamSelect">Home Team:</label>
    <select id="homeTeamSelect">
      <option value="49ers" selected>49ers</option>
      <option value="Cowboys">Cowboys</option>
      <option value="Eagles">Eagles</option>
      <option value="Packers">Packers</option>
      <option value="Giants">Giants</option>
    </select>

    <label for="awayTeamSelect">Away Team:</label>
    <select id="awayTeamSelect">
      <option value="Cowboys">Cowboys</option>
      <option value="Eagles">Eagles</option>
      <option value="Packers">Packers</option>
      <option value="Giants">Giants</option>
      <option value="49ers">49ers</option>
    </select>

    <button id="startGameBtn" aria-label="Start Game">Start Game</button>
  </div>

  <!-- Game Screen -->
  <div id="game" style="display:none;">
    <div id="scoreboard" aria-live="polite"></div>
    <div id="situation" aria-live="polite"></div>

    <!-- Offensive Playbook -->
    <div id="offensePlays" style="display:none;" aria-label="Offensive Playbook">
      <h3>Offensive Playbook</h3>
      <button id="runPlayBtn" aria-label="Run Play">Run Play</button>
      <button id="shortPassBtn" aria-label="Short Pass Play">Short Pass</button>
      <button id="longPassBtn" aria-label="Long Pass Play">Long Pass</button>
    </div>

    <!-- Defensive Playbook -->
    <div id="defensePlays" style="display:none;" aria-label="Defensive Playbook">
      <h3>Defensive Playbook</h3>
      <button id="blitzBtn" aria-label="Blitz Defense">Blitz</button>
      <button id="zoneBtn" aria-label="Zone Defense">Zone</button>
      <button id="manBtn" aria-label="Man Coverage Defense">Man Coverage</button>
    </div>

    <!-- Fourth Down Options -->
    <div id="fourthDownOptions" style="display:none;" aria-label="Fourth Down Options">
      <h3>Fourth Down Options</h3>
      <button id="fieldGoalBtn" aria-label="Kick Field Goal">Kick Field Goal</button>
      <button id="puntBtn" aria-label="Punt Ball">Punt</button>
      <button id="goForItBtn" aria-label="Go For It on Fourth Down">Go For It</button>
    </div>

    <button id="nextQuarterBtn" aria-label="Next Quarter">Next Quarter</button>
  </div>

  <script>
    window.onload = function() {
      let homeTeam = "49ers";
      let awayTeam = "Eagles";
      let homeScore = 0;
      let awayScore = 0;
      let lastHomeScore = 0;
      let lastAwayScore = 0;
      let possession = "home";
      let currentDown = 1;
      let yardsToFirst = 10;
      let ballPosition = 25;
      let quarter = 1;
      let defenseChoice = "zone";
      let defenseActive = false;

      function announce(message) {
        const liveRegion = document.getElementById('situation');
        liveRegion.innerText = message;
      }

      function updateScore() {
        document.getElementById('scoreboard').innerText = `${homeTeam} ${homeScore} - ${awayScore} ${awayTeam}`;
        // Announce only when score changes
        if (homeScore !== lastHomeScore || awayScore !== lastAwayScore) {
          announce(`Score Update: ${homeTeam} ${homeScore}, ${awayTeam} ${awayScore}`);
          lastHomeScore = homeScore;
          lastAwayScore = awayScore;
        }
      }

      function updateSituation() {
        let teamWithBall = (possession === "home") ? homeTeam : awayTeam;
        document.getElementById('situation').innerText =
          `${currentDown} and ${yardsToFirst} at the ${ballPosition} yard line. ${teamWithBall} ball.`;
        updateScore();
      }

      function startQuickPlay() {
        document.getElementById('menu').style.display = 'none';
        document.getElementById('teamSelection').style.display = 'block';
        announce("Quick Play selected. Choose your home and away teams.");
      }

      function startGame() {
        homeTeam = document.getElementById('homeTeamSelect').value;
        awayTeam = document.getElementById('awayTeamSelect').value;
        homeScore = lastHomeScore = 0;
        awayScore = lastAwayScore = 0;
        possession = "home";
        currentDown = 1;
        yardsToFirst = 10;
        ballPosition = 25;
        quarter = 1;

        document.getElementById('teamSelection').style.display = 'none';
        document.getElementById('game').style.display = 'block';
        document.getElementById('offensePlays').style.display = 'block';
        document.getElementById('defensePlays').style.display = 'none';
        updateSituation();
        announce(`Game starting. ${homeTeam} vs ${awayTeam}. ${homeTeam} has the ball at the ${ballPosition} yard line.`);
      }

      function startFranchise() {
        announce("Franchise Mode coming soon!");
      }

      function showDefensePlays() {
        document.getElementById('offensePlays').style.display = 'none';
        document.getElementById('defensePlays').style.display = 'block';
        defenseActive = true;
        announce(`Select a defensive play for ${(possession === "home" ? awayTeam : homeTeam)} on offense.`);
      }

      function chooseDefense(choice) {
        defenseChoice = choice;
        defenseActive = false;
        document.getElementById('defensePlays').style.display = 'none';
        document.getElementById('offensePlays').style.display = 'block';
        announce(`Defense sets ${choice}. Now it's ${(possession === "home" ? homeTeam : awayTeam)} turn on offense.`);
        if (possession !== "home") {
          // Automatically run opponent plays
          autoPlay(possession);
        }
      }

      function callPlay(playType, auto=false) {
        let yards = 0;

        if (playType === 'run') {
          yards = Math.floor(Math.random() * 3) + 2;
          if (defenseChoice === "blitz") yards -= 1;
        } else if (playType === 'shortPass') {
          yards = Math.floor(Math.random() * 6) + 10;
          if (defenseChoice === "zone") yards -= 5;
        } else if (playType === 'longPass') {
          yards = Math.floor(Math.random() * 11) + 30;
          if (defenseChoice === "man") yards -= 10;
        } else if (playType === 'goForIt') {
          yards = Math.floor(Math.random() * 10) + 1;
        }

        if (yards < 0) yards = 0;

        ballPosition += yards;
        yardsToFirst -= yards;

        let msg = `${(possession === "home" ? homeTeam : awayTeam)} gained ${yards} yards. `;

        if (ballPosition >= 100) {
          msg += "Touchdown!";
          if (possession === "home") homeScore += 7; else awayScore += 7;
          changePossession(true);
        } else if (yardsToFirst <= 0) {
          currentDown = 1;
          yardsToFirst = 10;
          msg += "First down!";
        } else {
          currentDown++;
          if (currentDown > 4) {
            msg += "Turnover on downs.";
            changePossession();
          }
        }

        updateSituation();
        if (!auto) announce(`${msg} Current down: ${currentDown}, ${yardsToFirst} yards to first down, ball at ${ballPosition} yard line.`);

        // If possession switched, show defensive plays or auto opponent
        if (!auto && possession !== "home") {
          showDefensePlays();
        }
      }

      function autoPlay(team) {
        const plays = ['run', 'shortPass', 'longPass'];
        let numPlays = 1;
        function nextAutoPlay() {
          if (possession !== team) return; // stop if possession changes
          let play = plays[Math.floor(Math.random()*plays.length)];
          callPlay(play, true);
          setTimeout(nextAutoPlay, 1000);
        }
        nextAutoPlay();
      }

      function punt() {
        let puntYards = Math.floor(Math.random() * 20) + 40;
        ballPosition = 100 - puntYards;
        changePossession();
        let teamWithBall = (possession === "home") ? homeTeam : awayTeam;
        announce(`Punt goes ${puntYards} yards. ${teamWithBall} takes over at the ${ballPosition} yard line.`);
        updateSituation();
        if (possession !== "home") autoPlay(possession);
      }

      function fieldGoal() {
        if (ballPosition >= 60) {
          announce("Field goal is good!");
          if (possession === "home") homeScore += 3; else awayScore += 3;
        } else {
          announce("Field goal is no good.");
        }
        changePossession(true);
        updateSituation();
        if (possession !== "home") autoPlay(possession);
      }

      function changePossession(reset=false) {
        possession = (possession === "home") ? "away" : "home";
        currentDown = 1;
        yardsToFirst = 10;
        ballPosition = reset ? 25 : 100 - ballPosition;
      }

      function nextQuarter() {
        quarter++;
        if (quarter === 3) {
          announce("Halftime show starting!");
        } else if (quarter > 4) {
          announce("Game Over! Final score " +
            `${homeTeam} ${homeScore}, ${awayTeam} ${awayScore}`);
        } else {
          announce(`Starting Quarter ${quarter}`);
        }
      }

      // Attach button events
      document.getElementById('quickPlayBtn').onclick = startQuickPlay;
      document.getElementById('franchiseBtn').onclick = startFranchise;
      document.getElementById('startGameBtn').onclick = startGame;
      document.getElementById('runPlayBtn').onclick = () => callPlay('run');
      document.getElementById('shortPassBtn').onclick = () => callPlay('shortPass');
      document.getElementById('longPassBtn').onclick = () => callPlay('longPass');
      document.getElementById('blitzBtn').onclick = () => chooseDefense('blitz');
      document.getElementById('zoneBtn').onclick = () => chooseDefense('zone');
      document.getElementById('manBtn').onclick = () => chooseDefense('man');
      document.getElementById('fieldGoalBtn').onclick = fieldGoal;
      document.getElementById('puntBtn').onclick = punt;
      document.getElementById('goForItBtn').onclick = () => callPlay('goForIt');
      document.getElementById('nextQuarterBtn').onclick = nextQuarter;
    }
  </script>
</body>
</html>