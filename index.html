<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pok√©mon Adventure ‚Äî Mobile Web App</title>
  <meta name="description" content="Explore, collect, battle, and heal Pok√©mon ‚Äî a mobile-first accessible web app that stores your collection locally." />
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --accent:#1e90ff;
      --muted:#94a3b8;
      --success:#16a34a;
      --danger:#ef4444;
      --glass: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;color:#e6eef8;background:linear-gradient(180deg,var(--bg),#071025);-webkit-font-smoothing:antialiased}
    .app{max-width:540px;margin:0 auto;min-height:100vh;display:flex;flex-direction:column}
    header{padding:14px 16px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);display:flex;align-items:center;justify-content:space-between}
    header h1{font-size:18px;margin:0}
    header button{background:transparent;border:1px solid var(--glass);color:var(--muted);padding:8px 12px;border-radius:10px}main{flex:1;padding:16px;}
.card{background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);border-radius:14px;padding:12px;margin-bottom:12px;box-shadow:0 6px 18px rgba(2,6,23,0.6)}
.center{display:flex;align-items:center;justify-content:center}

/* Bottom tab bar */
.tabbar{position:sticky;bottom:0;display:flex;gap:6px;padding:10px;background:linear-gradient(0deg,rgba(2,6,23,0.6),transparent);backdrop-filter:blur(6px);justify-content:space-around}
.tabbtn{flex:1;padding:10px;border-radius:12px;background:var(--card);text-align:center;border:1px solid rgba(255,255,255,0.02)}
.tabbtn[aria-current="true"]{outline:3px solid rgba(30,144,255,0.16);box-shadow:0 6px 12px rgba(30,144,255,0.06)}
.tabbtn .label{display:block;font-size:12px;color:var(--muted)}
.tabbtn .icon{font-size:18px;margin-bottom:6px}

/* Pokedex grid */
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.mon{background:linear-gradient(0deg,rgba(255,255,255,0.02),transparent);padding:10px;border-radius:10px;text-align:center;border:1px solid rgba(255,255,255,0.02)}
.sprite{font-size:36px;height:48px;display:flex;align-items:center;justify-content:center}
.name{font-size:13px;margin-top:6px}
.locked{filter:grayscale(100%) opacity(0.28)}

/* explore area */
.explore-area{display:flex;flex-direction:column;gap:10px}
.big-card{padding:18px;border-radius:14px;text-align:center}
.action-row{display:flex;gap:8px;justify-content:center}
.btn{padding:12px 14px;border-radius:10px;border:none;font-weight:600}
.btn.primary{background:var(--accent);color:white}
.btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
.btn.warn{background:var(--danger);color:white}

/* battle */
.battle-screen{display:flex;flex-direction:column;gap:12px}
.battle-row{display:flex;justify-content:space-between;align-items:center}
.stat{font-size:13px;color:var(--muted)}

/* footer text */
.muted{color:var(--muted);font-size:13px}

/* responsive */
@media(min-width:540px){.app{border-radius:16px;margin-top:24px;box-shadow:0 12px 40px rgba(2,6,23,0.6)}}

/* focus for accessibility */
button:focus{outline:3px solid rgba(30,144,255,0.16)}

  </style>
</head>
<body>
  <div class="app" role="application" aria-labelledby="appTitle">
    <header>
      <h1 id="appTitle">Pok√©mon Adventure</h1>
      <div>
        <button id="closeBtn" aria-label="Close button. Double tap to activate.">Close</button>
      </div>
    </header><main id="main">
  <!-- Home / Pokedex -->
  <section id="home" class="tab card" role="region" aria-labelledby="homeTitle">
    <h2 id="homeTitle">Home ‚Äî Your Pok√©dex</h2>
    <p class="muted">All the Pok√©mon you've collected. Double tap a Pok√©mon to view details.</p>
    <div id="pokedexGrid" class="grid" aria-live="polite"></div>
  </section>

  <!-- Explore -->
  <section id="explore" class="tab card" role="region" aria-labelledby="exploreTitle" hidden>
    <h2 id="exploreTitle">Explore</h2>
    <p class="muted">Tap "Explore Area" to find wild Pok√©mon. Then try to catch them.</p>
    <div class="explore-area">
      <div id="wildCard" class="big-card card center" aria-live="polite">
        <div id="wildSprite" class="sprite" aria-hidden="true">üå±</div>
        <div id="wildName" class="name">No Pok√©mon found yet</div>
        <div id="wildInfo" class="muted">‚Äî</div>
      </div>

      <div class="action-row">
        <button id="exploreBtn" class="btn primary" aria-label="Explore Area. Double tap to activate.">Explore Area</button>
        <button id="runBtn" class="btn secondary" aria-label="Run away. Double tap to activate.">Run</button>
      </div>

      <div class="action-row">
        <button id="catchBtn" class="btn primary" disabled aria-label="Catch Pok√©mon. Double tap to activate.">Catch</button>
        <button id="fleeBtn" class="btn secondary" disabled aria-label="Flee. Double tap to activate.">Flee</button>
      </div>
    </div>
  </section>

  <!-- Battle -->
  <section id="battle" class="tab card" role="region" aria-labelledby="battleTitle" hidden>
    <h2 id="battleTitle">Battle</h2>
    <p class="muted">Pick one of your Pok√©mon to fight a wild Pok√©mon. Winning may reward you with a special Pok√©mon or item.</p>
    <div id="battleArea" class="battle-screen">
      <div id="selectYour" class="card">
        <div class="muted">Choose your Pok√©mon</div>
        <div id="yourGrid" class="grid" aria-live="polite"></div>
      </div>

      <div id="battleCard" class="card" hidden>
        <div class="battle-row">
          <div>
            <div id="yourPickSprite" class="sprite">üôÇ</div>
            <div id="yourPickName" class="name">‚Äî</div>
            <div id="yourPickHP" class="muted">HP: ‚Äî / ‚Äî</div>
          </div>
          <div>
            <div id="wildPickSprite" class="sprite">üëæ</div>
            <div id="wildPickName" class="name">‚Äî</div>
            <div id="wildPickHP" class="muted">HP: ‚Äî / ‚Äî</div>
          </div>
        </div>
        <div class="action-row">
          <button id="attackBtn" class="btn primary" aria-label="Attack. Double tap to activate.">Attack</button>
          <button id="useItemBtn" class="btn secondary" aria-label="Use item. Double tap to activate.">Use Item</button>
        </div>
        <div id="battleLog" class="muted" style="padding-top:8px;min-height:40px" aria-live="polite"></div>
      </div>
    </div>
  </section>

  <!-- Cookie Center (Heal) -->
  <section id="cooki" class="tab card" role="region" aria-labelledby="cookiTitle" hidden>
    <h2 id="cookiTitle">Cookie Center</h2>
    <p class="muted">Heal your Pok√©mon here ‚Äî use cookies to restore HP.</p>
    <div class="card">
      <div class="muted">Your cookies: <span id="cookieCount">0</span></div>
      <div style="margin-top:10px" class="action-row">
        <button id="healAllBtn" class="btn primary" aria-label="Heal all Pok√©mon. Double tap to activate.">Heal All</button>
        <button id="healSelectedBtn" class="btn secondary" aria-label="Heal selected Pok√©mon. Double tap to activate.">Heal Selected</button>
      </div>
      <div class="muted" style="margin-top:10px">Tip: Winning battles earns cookies. Explore to catch more Pok√©mon.</div>
    </div>

    <div style="margin-top:8px">
      <div class="muted">Your Pok√©mon (select to heal):</div>
      <div id="healGrid" class="grid" aria-live="polite"></div>
    </div>
  </section>

</main>

<nav class="tabbar" role="tablist" aria-label="Main tabs">
  <button class="tabbtn" role="tab" aria-current="true" data-tab="home" aria-label="Home, Pok√©dex tab. Double tap to activate."><div class="icon">üìö</div><span class="label">Home</span></button>
  <button class="tabbtn" role="tab" data-tab="explore" aria-label="Explore tab. Double tap to activate."><div class="icon">üåø</div><span class="label">Explore</span></button>
  <button class="tabbtn" role="tab" data-tab="battle" aria-label="Battle tab. Double tap to activate."><div class="icon">‚öîÔ∏è</div><span class="label">Battle</span></button>
  <button class="tabbtn" role="tab" data-tab="cooki" aria-label="Cookie Center tab. Double tap to activate."><div class="icon">üç™</div><span class="label">Cookie Center</span></button>
</nav>

  </div>  <script>
    // --- Data ---
    const POKEMON = [
      {id:1, name:'Pikachu', emoji:'‚ö°', rarity:0.18, maxHP:60},
      {id:2, name:'Bulbasaur', emoji:'üå±', rarity:0.15, maxHP:64},
      {id:3, name:'Charmander', emoji:'üî•', rarity:0.15, maxHP:62},
      {id:4, name:'Squirtle', emoji:'üíß', rarity:0.15, maxHP:63},
      {id:5, name:'Eevee', emoji:'‚ú®', rarity:0.12, maxHP:70},
      {id:6, name:'Jigglypuff', emoji:'üé§', rarity:0.1, maxHP:78},
      {id:7, name:'Meowth', emoji:'ü™ô', rarity:0.08, maxHP:58},
      {id:8, name:'Snorlax', emoji:'üò¥', rarity:0.05, maxHP:160},
      {id:9, name:'Psyduck', emoji:'ü§Ø', rarity:0.06, maxHP:66},
      {id:10, name:'Gengar', emoji:'üëª', rarity:0.04, maxHP:88}
    ];

    // Local storage keys
    const KEY = 'pkm_adventure_v1';

    // --- App State ---
    let state = {collection:{}, party:[], cookies:0};
    let wild = null; // current wild encounter
    let selectedBattleMon = null; // player's chosen mon copy with hp
    let selectedHeal = null;

    // --- Utilities ---
    function save() {localStorage.setItem(KEY, JSON.stringify(state));}
    function load(){
      try{const s=localStorage.getItem(KEY); if(s){state=JSON.parse(s);} else {initNew();}}
      catch(e){console.error(e); initNew();}
    }
    function initNew(){state={collection:{},party:[],cookies:0}; // give starter pokedex entry
      // give one starter: Pikachu
      addToCollection(1); state.party=[1]; state.cookies=3; save();}

    function addToCollection(id){ if(!state.collection[id]){ state.collection[id]={id: id, owned:true, seen:true, hp: getPokemonById(id).maxHP}; save(); }}
    function getPokemonById(id){ return POKEMON.find(p=>p.id===id); }
    function rand(){return Math.random();}

    // Pick a random POKEMON based on rarity weights
    function pickWild(){
      // weight is rarity; normalize
      const pool = POKEMON.slice();
      const total = pool.reduce((s,p)=>s+p.rarity,0);
      let r=Math.random()*total; for(const p of pool){ r-=p.rarity; if(r<=0) return p; }
      return pool[pool.length-1];
    }

    // --- UI helpers ---
    function $(sel){return document.querySelector(sel);} function $all(sel){return [...document.querySelectorAll(sel)];}

    // Render Pokedex Grid
    function renderPokedex(){ const grid=$('#pokedexGrid'); grid.innerHTML='';
      for(const p of POKEMON){ const owned = !!state.collection[p.id]; const div=document.createElement('button'); div.className='mon'; div.setAttribute('aria-label', owned?`${p.name}, collected`:`Unknown Pok√©mon, locked`); div.dataset.id=p.id; div.type='button';
        div.innerHTML=`<div class="sprite ${owned? '':'locked'}">${owned? p.emoji : '‚ùì'}</div><div class="name">${owned? p.name : 'Unknown'}</div>`;
        div.addEventListener('click',()=> showMonDetails(p.id));
        grid.appendChild(div);
      }
    }

    function showMonDetails(id){ const p=getPokemonById(Number(id)); const owned = !!state.collection[p.id]; alert(`${p.name}\n\n${owned? 'Owned' : 'Not owned yet'}\nHP: ${p.maxHP}\nRarity: ${Math.round(p.rarity*100)}%`); }

    // Explore UI
    function renderWild(){ if(!wild){ $('#wildSprite').textContent='üå±'; $('#wildName').textContent='No Pok√©mon found yet'; $('#wildInfo').textContent='‚Äî'; $('#catchBtn').disabled=true; $('#fleeBtn').disabled=true; } else { $('#wildSprite').textContent=wild.emoji; $('#wildName').textContent=wild.name; $('#wildInfo').textContent=`Rarity: ${Math.round(wild.rarity*100)}%`; $('#catchBtn').disabled=false; $('#fleeBtn').disabled=false; }}

    // Battle UI
    function renderYourGrid(){ const grid=$('#yourGrid'); grid.innerHTML='';
      const ownedIds = Object.keys(state.collection).map(Number);
      if(ownedIds.length===0){ grid.innerHTML='<div class="muted">No Pok√©mon yet ‚Äî explore to find some!</div>'; return; }
      for(const id of ownedIds){ const p=getPokemonById(id); const btn=document.createElement('button'); btn.className='mon'; btn.type='button'; btn.dataset.id=id; const hp=state.collection[id].hp || p.maxHP; btn.innerHTML=`<div class="sprite">${p.emoji}</div><div class="name">${p.name}</div><div class="muted">HP: ${hp}/${p.maxHP}</div>`;
          btn.addEventListener('click',()=> pickYourMonForBattle(id)); grid.appendChild(btn); }
    }

    function pickYourMonForBattle(id){ const p=getPokemonById(Number(id)); const record = state.collection[id]; selectedBattleMon={ ...p, hp: record.hp ?? p.maxHP}; $('#yourPickSprite').textContent=p.emoji; $('#yourPickName').textContent=p.name; $('#yourPickHP').textContent=`HP: ${selectedBattleMon.hp} / ${p.maxHP}`; prepareWildForBattle(); $('#battleCard').hidden=false; }

    function prepareWildForBattle(){ const w = pickWild(); // create copy with hp
      wildPick = {...w, hp: Math.min(w.maxHP, Math.floor(w.maxHP * (0.6 + Math.random()*0.6)))}; // random HP between 60% - 120%
      window.currentWild = wildPick; $('#wildPickSprite').textContent=wildPick.emoji; $('#wildPickName').textContent=wildPick.name; $('#wildPickHP').textContent=`HP: ${wildPick.hp} / ${wildPick.maxHP}`; $('#battleLog').textContent='A wild '+wildPick.name+' appeared!'; }

    // Battle mechanics: simple turn-based where attack subtracts random damage
    function playerAttack(){ if(!selectedBattleMon || !window.currentWild) return; const atk = Math.max(1, Math.floor( (5 + Math.random()*10) )); window.currentWild.hp -= atk; $('#battleLog').textContent = `${selectedBattleMon.name} attacks for ${atk} damage!`;
      if(window.currentWild.hp <=0){ winBattle(); return; } else { $('#wildPickHP').textContent=`HP: ${Math.max(0,window.currentWild.hp)} / ${window.currentWild.maxHP}`; setTimeout(wildAttack,800); }
    }
    function wildAttack(){ if(!selectedBattleMon || !window.currentWild) return; const atk = Math.max(1, Math.floor( (3 + Math.random()*8) )); selectedBattleMon.hp -= atk; $('#battleLog').textContent = `${window.currentWild.name} attacks for ${atk} damage!`;
      $('#yourPickHP').textContent=`HP: ${Math.max(0,selectedBattleMon.hp)} / ${selectedBattleMon.maxHP}`;
      if(selectedBattleMon.hp <=0){ loseBattle(); return; } }

    function winBattle(){ $('#battleLog').textContent = `You defeated ${window.currentWild.name}!`;
      // reward: cookies and chance to add special pokemon
      const gainedCookies = Math.floor(1 + Math.random()*3); state.cookies += gainedCookies; const gotRare = Math.random() < 0.35; if(gotRare){ // give random not-yet-owned pokemon if possible
        const notOwned = POKEMON.filter(p=>!state.collection[p.id]); if(notOwned.length>0){ const pick = notOwned[Math.floor(Math.random()*notOwned.length)]; addToCollection(pick.id); $('#battleLog').textContent += ` You found a special Pok√©mon: ${pick.name}! (+${gainedCookies} cookies)`; } else { $('#battleLog').textContent += ` You earned ${gainedCookies} cookies!`; }
      } else { $('#battleLog').textContent += ` You earned ${gainedCookies} cookies!`; }
      // reduce party HP
      if(selectedBattleMon){ // update saved HP for that pokemon id
        state.collection[selectedBattleMon.id].hp = Math.max(0,selectedBattleMon.hp);
      }
      save(); renderAll(); setTimeout(()=>{ $('#battleCard').hidden=true; },900);
    }
    function loseBattle(){ $('#battleLog').textContent = `Your ${selectedBattleMon.name} fainted...`; // set hp to 0
      state.collection[selectedBattleMon.id].hp = 0; save(); renderAll(); setTimeout(()=>{ $('#battleCard').hidden=true; },900);
    }

    // Items (simple)
    function useItem(){ if(!selectedBattleMon) return; // heal some
      const heal = Math.floor(6 + Math.random()*12); selectedBattleMon.hp = Math.min(selectedBattleMon.maxHP, selectedBattleMon.hp + heal); $('#battleLog').textContent = `${selectedBattleMon.name} regained ${heal} HP!`; $('#yourPickHP').textContent=`HP: ${selectedBattleMon.hp} / ${selectedBattleMon.maxHP}`;
    }

    // --- Explore actions ---
    function doExplore(){ wild = pickWild(); renderWild(); $('#wildCard').classList.add('found'); $('#exploreBtn').textContent='Searching...'; setTimeout(()=>{ $('#exploreBtn').textContent='Explore Area'; renderWild(); },600);
    }
    function doCatch(){ if(!wild) return; // simple catch chance: based on rarity and randomness
      const base = 0.35 + (0.5 - wild.rarity); // tweak so rarer are harder
      const roll = Math.random(); const success = roll < base;
      if(success){ addToCollection(wild.id); state.cookies += 1; alert(`Caught ${wild.name}! Added to your Pok√©dex.`); }
      else { alert(`Oh no ‚Äî ${wild.name} broke free!`); }
      wild = null; renderWild(); renderAll(); save(); }
    function doFlee(){ wild = null; renderWild(); }

    // --- Cookie Center actions ---
    function renderCookieCenter(){ $('#cookieCount').textContent = state.cookies; const g = $('#healGrid'); g.innerHTML=''; const ownedIds = Object.keys(state.collection).map(Number); if(ownedIds.length===0){ g.innerHTML='<div class="muted">You have no Pok√©mon.</div>'; return; }
      for(const id of ownedIds){ const p = getPokemonById(id); const rec = state.collection[id]; const btn=document.createElement('button'); btn.className='mon'; btn.type='button'; btn.dataset.id=id; btn.innerHTML=`<div class="sprite">${p.emoji}</div><div class="name">${p.name}</div><div class="muted">HP: ${rec.hp || p.maxHP} / ${p.maxHP}</div>`; btn.addEventListener('click',()=>{ // toggle selection
          const prev = selectedHeal; if(prev===id){ selectedHeal=null; btn.style.outline=''; } else { selectedHeal=id; // clear others
            $all('#healGrid .mon').forEach(n=>n.style.outline=''); btn.style.outline='3px solid rgba(30,144,255,0.16)'; }
        }); g.appendChild(btn); }
    }
    function healAll(){ if(state.cookies<=0){ alert('No cookies ‚Äî win battles to earn cookies.'); return; } state.cookies = Math.max(0, state.cookies - 1); for(const k of Object.keys(state.collection)){ const id=Number(k); state.collection[id].hp = getPokemonById(id).maxHP; } save(); renderAll(); alert('All Pok√©mon healed. 1 cookie used.'); }
    function healSelected(){ if(!selectedHeal){ alert('Select a Pok√©mon to heal.'); return; } if(state.cookies<=0){ alert('No cookies left.'); return; } state.cookies--; state.collection[selectedHeal].hp = getPokemonById(selectedHeal).maxHP; selectedHeal=null; save(); renderAll(); renderCookieCenter(); alert('Healed selected Pok√©mon.'); }

    // --- Tab navigation ---
    $all('.tabbtn').forEach(btn=> btn.addEventListener('click', ()=>{ const tab=btn.dataset.tab; showTab(tab); }));
    function showTab(tabName){ $all('.tabbtn').forEach(b=> b.setAttribute('aria-current','false')); $all(`.tabbtn[data-tab="${tabName}"]`).forEach(b=> b.setAttribute('aria-current','true'));
      $all('.tab').forEach(s=> s.hidden = s.id !== tabName);
      // set focus into region for screen readers
      setTimeout(()=>{ document.getElementById(tabName).focus?.(); },150);
      // render relevant
      if(tabName==='home') renderPokedex();
      if(tabName==='explore') renderWild();
      if(tabName==='battle'){ renderYourGrid(); }
      if(tabName==='cooki') renderCookieCenter();
    }

    // --- General render ---
    function renderAll(){ renderPokedex(); renderWild(); renderYourGrid(); renderCookieCenter(); $('#cookieCount').textContent = state.cookies; }

    // --- Events ---
    function wire(){ $('#closeBtn').addEventListener('click', ()=>{ // polite close experience
        if(confirm('Exit Pok√©mon Adventure? The app will remain saved in your browser.')){ document.body.innerHTML = '<div style="padding:30px;color:#e6eef8;background:#071025;height:100vh;display:flex;align-items:center;justify-content:center"><div><h2>Goodbye!</h2><p class="muted">Return to this page to play again. Your Pok√©dex is saved locally.</p></div></div>';} });

      $('#exploreBtn').addEventListener('click', doExplore);
      $('#runBtn').addEventListener('click', ()=>{ wild=null; renderWild(); });
      $('#catchBtn').addEventListener('click', doCatch);
      $('#fleeBtn').addEventListener('click', doFlee);

      $('#attackBtn').addEventListener('click', ()=>{ playerAttack(); });
      $('#useItemBtn').addEventListener('click', useItem);

      $('#healAllBtn').addEventListener('click', healAll);
      $('#healSelectedBtn').addEventListener('click', healSelected);

      // allow tapping pokedex items to view
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') showTab('home'); });
    }

    // --- Boot ---
    load(); wire(); renderAll(); // default tab
    showTab('home');

    // Accessibility: make sections focusable
    $all('.tab').forEach(s=> s.tabIndex=0);

    // small onboarding
    if(!localStorage.getItem(KEY+'_seen_tour')){
      localStorage.setItem(KEY+'_seen_tour','1');
      setTimeout(()=> alert('Welcome to Pok√©mon Adventure! Use the tabs at the bottom to navigate. Explore to find Pok√©mon, then try battles later. Double tap buttons to activate them with a screen reader.'),400);
    }
  </script></body>
</html>