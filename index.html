<!DOCTYPE html>
<html>
<head>
  <title>Madden Style Football</title>
  <style>
    button, select { display:block; margin:10px; font-size:18px; }
    #game, #teamSelection { display:none; }
  </style>
</head>
<body>
<h1>Madden Style Football</h1>

<!-- Main Menu -->
<div id="menu">
  <button id="quickPlayBtn">Quick Play</button>
  <button id="franchiseBtn">Franchise</button>
</div>

<!-- Team Selection -->
<div id="teamSelection">
  <h3>Select Teams</h3>
  <label for="homeTeamSelect">Home Team:</label>
  <select id="homeTeamSelect"></select>
  <label for="awayTeamSelect">Away Team:</label>
  <select id="awayTeamSelect"></select>
  <button id="startGameBtn">Start Game</button>
</div>

<!-- Game Screen -->
<div id="game">
  <div id="scoreboard" aria-live="polite"></div>
  <div id="situation" aria-live="polite"></div>
  <div id="quarterClock" aria-live="polite"></div>
  <div id="aiAnnounce" aria-live="polite" style="position:absolute; left:-9999px;"></div>

  <!-- Offensive Playbook -->
  <div id="offensePlays">
    <h3>Offensive Playbook</h3>
    <button id="runPlayBtn">Run Play</button>
    <button id="shortPassBtn">Short Pass</button>
    <button id="longPassBtn">Long Pass</button>
    <button id="drawBtn">Draw</button>
    <button id="playActionBtn">Play Action</button>
  </div>

  <!-- Defensive Playbook -->
  <div id="defensePlays">
    <h3>Defensive Playbook</h3>
    <button id="blitzBtn">Blitz</button>
    <button id="zoneBtn">Zone</button>
    <button id="manBtn">Man Coverage</button>
    <button id="preventBtn">Prevent</button>
  </div>

  <!-- Fourth Down Options -->
  <div id="fourthDownOptions">
    <h3>Fourth Down Options</h3>
    <button id="fieldGoalBtn">Kick Field Goal</button>
    <button id="puntBtn">Punt Ball</button>
    <button id="goForItBtn">Go For It</button>
  </div>
</div>

<script>
window.onload = function() {

  // ===== TEAMS =====
  const teams = ["49ers","Eagles","Cowboys","Packers","Chiefs","Bills","Bengals","Ravens",
    "Steelers","Browns","Jets","Giants","Dolphins","Patriots","Chargers","Raiders",
    "Broncos","Texans","Titans","Colts","Jaguars","Commanders","Seahawks","Rams",
    "Cardinals","Lions","Vikings","Bears","Saints","Falcons","Panthers","Buccaneers"];

  const homeSelect = document.getElementById("homeTeamSelect");
  const awaySelect = document.getElementById("awayTeamSelect");
  teams.forEach(team=>{
    let opt1 = document.createElement("option"); opt1.value=opt1.textContent=team; homeSelect.appendChild(opt1);
    let opt2 = document.createElement("option"); opt2.value=opt2.textContent=team; awaySelect.appendChild(opt2);
  });
  homeSelect.value = "49ers";

  // ===== 49ERS ROSTER =====
  const ninersRoster = ["Trey Lance","Christian McCaffrey","Deebo Samuel","Brandon Aiyuk","George Kittle",
    "Tyrion Davis-Price","Jauan Jennings","Elijah Mitchell","Richie James","Rashod Bateman"];

  // ===== GAME STATE =====
  let homeTeam="49ers", awayTeam="Eagles", homeScore=0, awayScore=0;
  let lastAnnouncedHomeScore=0, lastAnnouncedAwayScore=0;
  let possession="home", currentDown=1, yardsToFirst=10, ballPosition=25, quarter=1;
  let defenseChoice="zone", quarterTime=15*60, quarterInterval=null;
  let weather="Clear";

  const aiAnnounce = document.getElementById('aiAnnounce');

  // ===== AUDIO =====
  const sounds={
    whistle:"https://cdn.pixabay.com/download/audio/2023/03/20/audio_d1f019a63f.mp3?filename=whistle-6287.mp3",
    crowdFirstDown:"https://cdn.pixabay.com/download/audio/2023/03/20/audio_6b2f015d13.mp3?filename=crowd-cheer-1st-down-6290.mp3",
    crowdTD:"https://cdn.pixabay.com/download/audio/2023/03/20/audio_1c0d7dbde4.mp3?filename=crowd-cheer-touchdown-6291.mp3",
    tackle:"https://cdn.pixabay.com/download/audio/2023/03/20/audio_9a8b4b6c48.mp3?filename=tackle-6288.mp3",
    kick:"https://cdn.pixabay.com/download/audio/2023/03/20/audio_4ef9f3e3f0.mp3?filename=kick-6289.mp3"
  };
  let audioElements={};
  for(let key in sounds){ audioElements[key] = new Audio(sounds[key]); }
  function playSound(key){ let a=audioElements[key]; a.currentTime=0; a.play(); }

  // ===== ANNOUNCE =====
  function announce(msg, ai=false){
    const t = ai ? aiAnnounce : document.getElementById('situation');
    t.innerText = msg;
  }

  // ===== SCOREBOARD =====
  function updateScore(announceScore=false){
    document.getElementById('scoreboard').innerText=`${homeTeam} ${homeScore} - ${awayScore} ${awayTeam}`;
    if(announceScore){
      if(homeScore!==lastAnnouncedHomeScore || awayScore!==lastAnnouncedAwayScore){
        announce(`Score Update: ${homeTeam} ${homeScore}, ${awayTeam} ${awayScore}`);
        lastAnnouncedHomeScore=homeScore; lastAnnouncedAwayScore=awayScore;
      }
    }
  }

  function updateSituation(){
    let teamWithBall = (possession==="home") ? homeTeam : awayTeam;
    document.getElementById('situation').innerText = `${currentDown} and ${yardsToFirst} at the ${ballPosition} yard line. ${teamWithBall} ball.`;
  }

  // ===== GAME FLOW =====
  function startQuickPlay(){
    document.getElementById('menu').style.display='none';
    document.getElementById('teamSelection').style.display='block';
    announce("Quick Play selected. Choose teams.");
  }

  function startGame(){
    homeTeam = homeSelect.value;
    awayTeam = awaySelect.value;
    homeScore=awayScore=0;
    lastAnnouncedHomeScore=lastAnnouncedAwayScore=0;
    possession="home"; currentDown=1; yardsToFirst=10; ballPosition=25; quarter=1; quarterTime=15*60;
    document.getElementById('teamSelection').style.display='none';
    document.getElementById('game').style.display='block';
    updateScore();
    updateSituation();
    startQuarterClock();
    announce(`Game starting: ${homeTeam} vs ${awayTeam}. ${homeTeam} has the ball.`);
  }

  // ===== QUARTER CLOCK =====
  function startQuarterClock(){
    if(quarterInterval) clearInterval(quarterInterval);
    quarterTime = 15*60;
    updateQuarterClockUI();
    quarterInterval = setInterval(()=>{
      quarterTime--;
      updateQuarterClockUI();
      if(quarterTime===120) announce("Two minute warning");
      if(quarterTime<=0){
        clearInterval(quarterInterval);
        announce(`End of Quarter ${quarter}`);
        quarter++;
        if(quarter<=4){ quarterTime=15*60; startQuarterClock(); }
        else{ announce(`Game Over! Final Score: ${homeTeam} ${homeScore}, ${awayTeam} ${awayScore}`);}
      }
    },1000);
  }

  function updateQuarterClockUI(){
    let min=Math.floor(quarterTime/60), sec=quarterTime%60;
    document.getElementById('quarterClock').innerText=`Quarter ${quarter}, Time Remaining: ${min}:${sec<10?'0'+sec:sec}`;
  }

  function showStats(){ announce(`Halftime stats: ${homeTeam} ${homeScore}, ${awayTeam} ${awayScore}. Ball at ${ballPosition}`); }

  // ===== BUTTONS =====
  document.getElementById('quickPlayBtn').onclick = startQuickPlay;
  document.getElementById('startGameBtn').onclick = startGame;

  // Keep all your offensive/defensive play button handlers here as before
};
</script>
</body>
</html>