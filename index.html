<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Football Game</title>
    <!-- Tailwind CSS CDN for easy and fast styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Apply a default font and dark background for the whole page */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* bg-gray-900 */
            color: #e2e8f0; /* text-gray-200 */
        }
        /* Style the main container to center the content on the screen */
        .game-container {
            max-width: 640px;
            margin: auto;
            padding: 1rem;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .game-display {
            width: 100%;
            height: 70vh; /* Adjust height as needed */
            border-radius: 0.75rem;
            overflow: hidden;
        }
        .game-display iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        /* Style for the simple modal message box */
        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            padding: 1rem 2rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            animation: fadeInOut 3s forwards;
        }

        @keyframes fadeInOut {
            0% { opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { opacity: 0; }
        }
    </style>
</head>
<body class="bg-gray-900">

    <!-- Main container for the game's UI -->
    <div class="game-container">

        <!-- Main Menu Screen (Visible by default) -->
        <div id="main-menu" class="w-full text-center">
            <h1 class="text-5xl md:text-6xl font-extrabold text-white text-center mb-10">
                <span class="text-indigo-400">Football</span> Game
            </h1>

            <div class="w-full flex flex-col gap-4">
                <!-- Main "Quick Play" game button -->
                <button
                    id="play-football-btn"
                    class="py-4 px-6 bg-gray-600 hover:bg-gray-700 text-white font-bold rounded-lg shadow-md transition duration-200"
                >
                    Quick Play
                </button>
                <!-- New "Franchise" button -->
                <button
                    id="franchise-btn"
                    class="py-4 px-6 bg-gray-600 hover:bg-gray-700 text-white font-bold rounded-lg shadow-md transition duration-200"
                >
                    Franchise
                </button>
                <!-- This button will be shown only if a game is saved -->
                <button
                    id="load-game-btn"
                    class="py-4 px-6 bg-yellow-600 hover:bg-yellow-700 text-white font-bold rounded-lg shadow-md transition duration-200 hidden"
                >
                    Load Last Game
                </button>
            </div>
        </div>
        
        <!-- Quick Play Screen (Hidden by default) -->
        <div id="quick-play-menu" class="w-full text-center hidden">
             <h2 class="text-4xl md:text-5xl font-bold text-white text-center mb-6">
                Choose Your Team
            </h2>
            
            <!-- Back to Menu button for the Quick Play screen -->
            <button
                id="back-to-menu-from-quick-play-btn"
                class="py-4 px-6 bg-gray-600 hover:bg-gray-700 text-white font-bold rounded-lg shadow-md transition duration-200"
            >
                Back to Main Menu
            </button>
            
            <!-- Teams list (for TalkBack accessibility) -->
            <ul id="teams-list" class="mt-8 grid grid-cols-2 gap-4">
                <!-- Teams will be populated here -->
            </ul>
        </div>

        <!-- Franchise Menu (Hidden by default) -->
        <div id="franchise-menu" class="w-full text-center hidden">
            <h2 class="text-4xl md:text-5xl font-bold text-white text-center mb-6">
                Franchise Mode
            </h2>
            
            <div class="w-full flex flex-col gap-4">
                <div class="flex flex-row gap-4 items-center">
                    <!-- Dropdown for saved franchises (initially empty) -->
                    <select id="franchise-saves-select" class="flex-grow py-3 px-4 bg-gray-700 rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                        <!-- Options will be dynamically added here -->
                        <option value="" disabled selected>No saved franchises</option>
                    </select>
                    <!-- Create New League button -->
                    <button
                        id="create-new-league-btn"
                        class="py-3 px-6 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-lg shadow-md transition duration-200"
                    >
                        Create New League
                    </button>
                </div>
            </div>

            <!-- Back to Main Menu button -->
            <button
                id="back-to-menu-from-franchise-btn"
                class="mt-6 py-4 px-6 bg-gray-600 hover:bg-gray-700 text-white font-bold rounded-lg shadow-md transition duration-200"
            >
                Back to Main Menu
            </button>
        </div>

        <!-- New League Menu (Hidden by default) -->
        <div id="new-league-menu" class="w-full text-center hidden">
            <h2 class="text-4xl md:text-5xl font-bold text-white text-center mb-6">
                Create New League
            </h2>

            <div class="w-full flex flex-col gap-4">
                <!-- Roster options using buttons -->
                <button class="py-4 px-6 bg-gray-700 hover:bg-gray-600 text-white font-bold rounded-lg transition duration-200">
                    Live Real Life Roster
                </button>
                <button class="py-4 px-6 bg-gray-700 hover:bg-gray-600 text-white font-bold rounded-lg transition duration-200">
                    Live Active Roster
                </button>
                <button class="py-4 px-6 bg-gray-700 hover:bg-gray-600 text-white font-bold rounded-lg transition duration-200">
                    Offline Preseason Roster
                </button>
                <button class="py-4 px-6 bg-gray-700 hover:bg-gray-600 text-white font-bold rounded-lg transition duration-200">
                    Offline Active Roster
                </button>
            </div>

            <!-- Back to Franchise Menu button -->
            <button
                id="back-to-franchise-btn"
                class="mt-6 py-4 px-6 bg-gray-600 hover:bg-gray-700 text-white font-bold rounded-lg shadow-md transition duration-200"
            >
                Back to Franchise Mode
            </button>
        </div>
        
        <!-- Game Settings Screen (Hidden by default) -->
        <div id="game-settings-menu" class="w-full text-center hidden">
            <h2 class="text-4xl md:text-5xl font-bold text-white text-center mb-6">
                Game Settings
            </h2>
            
            <div class="w-full flex flex-col gap-6 p-4 bg-gray-800 rounded-lg shadow-md">
                <!-- Quarter Length Slider -->
                <div class="flex flex-col">
                    <label for="quarter-length" class="text-lg text-gray-400 text-left">Quarter Length: <span id="quarter-length-value">15</span> min</label>
                    <input type="range" id="quarter-length" min="1" max="60" value="15" class="w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-700">
                </div>

                <!-- Game Time Slider -->
                <div class="flex flex-col">
                    <label for="game-time" class="text-lg text-gray-400 text-left">Game Time: <span id="game-time-value">12:00</span></label>
                    <input type="range" id="game-time" min="0" max="720" value="720" class="w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-700">
                </div>

                <!-- Weather Options Dropdown -->
                <div class="flex flex-col">
                    <label for="weather-select" class="text-lg text-gray-400 text-left">Weather Options</label>
                    <select id="weather-select" class="w-full py-3 px-4 bg-gray-700 rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                        <option value="clear">Clear</option>
                        <option value="cloudy">Cloudy</option>
                        <option value="partly-cloudy">Partly Cloudy</option>
                        <option value="overcast">Overcast</option>
                        <option value="sunny">Sunny</option>
                        <option value="rain">Rain</option>
                        <option value="heavy-rain">Heavy Rain</option>
                        <option value="snow">Snow</option>
                        <option value="heavy-snow">Heavy Snow</option>
                    </select>
                </div>

                <!-- Event Type Dropdown -->
                <div class="flex flex-col">
                    <label for="event-type-select" class="text-lg text-gray-400 text-left">Event Type</label>
                    <select id="event-type-select" class="w-full py-3 px-4 bg-gray-700 rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                        <option value="preseason">Preseason</option>
                        <option value="regular">Regular Season</option>
                        <option value="playoffs">Playoffs</option>
                        <option value="superbowl">Super Bowl</option>
                    </select>
                </div>
                
                <!-- Game Style Options Dropdown -->
                <div class="flex flex-col">
                    <label for="game-style-select" class="text-lg text-gray-400 text-left">Game Style Options</label>
                    <select id="game-style-select" class="w-full py-3 px-4 bg-gray-700 rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                        <option value="simulation">Simulation</option>
                        <option value="competitive">Competitive</option>
                        <option value="arcade">Arcade</option>
                    </select>
                </div>
            </div>
            
            <button
                id="start-quick-play-btn"
                class="mt-6 py-4 px-6 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-lg shadow-md transition duration-200"
            >
                Start Game
            </button>
            <button
                id="back-to-quick-play-btn"
                class="mt-4 py-4 px-6 bg-gray-600 hover:bg-gray-700 text-white font-bold rounded-lg shadow-md transition duration-200"
            >
                Back to Team Select
            </button>
        </div>
        
        <!-- Game Screen (Hidden by default) -->
        <div id="game-screen" class="w-full text-center hidden">
            <div class="game-display bg-gray-800 rounded-xl shadow-lg mb-4">
                <iframe id="game-iframe" title="Generated Game" sandbox="allow-scripts"></iframe>
            </div>
            <div class="flex flex-row justify-between w-full">
                <button
                    id="back-to-menu-from-game-btn"
                    class="py-4 px-6 bg-gray-600 hover:bg-gray-700 text-white font-bold rounded-lg shadow-md transition duration-200"
                >
                    Back to Menu
                </button>
                <button
                    id="save-game-btn"
                    class="py-4 px-6 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg shadow-md transition duration-200"
                >
                    Save Game
                </button>
            </div>
        </div>

    </div>

    <script>
        // Ensure the script runs after the document is fully loaded
        document.addEventListener('DOMContentLoaded', () => {

            // Get references to the HTML elements
            const mainMenu = document.getElementById('main-menu');
            const quickPlayMenu = document.getElementById('quick-play-menu');
            const franchiseMenu = document.getElementById('franchise-menu');
            const newLeagueMenu = document.getElementById('new-league-menu');
            const gameSettingsMenu = document.getElementById('game-settings-menu');
            const gameScreen = document.getElementById('game-screen');
            const playFootballBtn = document.getElementById('play-football-btn');
            const franchiseBtn = document.getElementById('franchise-btn');
            const loadGameBtn = document.getElementById('load-game-btn');
            const backToMenuFromQuickPlayBtn = document.getElementById('back-to-menu-from-quick-play-btn');
            const createNewLeagueBtn = document.getElementById('create-new-league-btn');
            const backToMenuFromFranchiseBtn = document.getElementById('back-to-menu-from-franchise-btn');
            const backToFranchiseBtn = document.getElementById('back-to-franchise-btn');
            const teamsList = document.getElementById('teams-list');
            const backToMenuFromGameBtn = document.getElementById('back-to-menu-from-game-btn');
            const gameIframe = document.getElementById('game-iframe');
            const saveGameBtn = document.getElementById('save-game-btn');
            
            const quarterLengthInput = document.getElementById('quarter-length');
            const quarterLengthValue = document.getElementById('quarter-length-value');
            const gameTimeInput = document.getElementById('game-time');
            const gameTimeValue = document.getElementById('game-time-value');
            
            // A list to hold the last saved game
            let lastSavedGame = null;
            let currentGameCode = ''; // Store the currently playing game code for saving

            // Simple placeholder HTML for the default "Football" game
            const footballGameCode = `
                <!DOCTYPE html>
                <html lang="en">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Football</title>
                    <style>
                        body {
                            font-family: sans-serif;
                            background-color: #38a169; /* a nice green field color */
                            color: white;
                            display: flex;
                            justify-content: center;
                            align-items: center;
                            height: 100vh;
                            margin: 0;
                            flex-direction: column;
                        }
                        .game-title {
                            font-size: 2rem;
                            font-weight: bold;
                            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
                        }
                    </style>
                </head>
                <body>
                    <h1 class="game-title">🏈 Football Game 🏈</h1>
                    <p class="mt-4 text-lg">This is a placeholder for your game logic.</p>
                    <p class="mt-2 text-sm">Use the "Save Game" button to save your progress!</p>
                </body>
                </html>
            `;

            // List of all 32 NFL teams
            const nflTeams = [
                'San Francisco 49ers', 'Arizona Cardinals', 'Atlanta Falcons', 'Baltimore Ravens', 'Buffalo Bills', 'Carolina Panthers',
                'Chicago Bears', 'Cincinnati Bengals', 'Cleveland Browns', 'Dallas Cowboys', 'Denver Broncos', 'Detroit Lions',
                'Green Bay Packers', 'Houston Texans', 'Indianapolis Colts', 'Jacksonville Jaguars', 'Kansas City Chiefs', 'Los Angeles Chargers',
                'Los Angeles Rams', 'Las Vegas Raiders', 'Miami Dolphins', 'Minnesota Vikings', 'New England Patriots', 'New Orleans Saints',
                'New York Giants', 'New York Jets', 'Philadelphia Eagles', 'Pittsburgh Steelers', 'Seattle Seahawks', 'Tampa Bay Buccaneers',
                'Tennessee Titans', 'Washington Commanders'
            ];
            
            // Helper function to show messages
            const showMessage = (message, type = 'success') => {
                const msgBox = document.createElement('div');
                msgBox.textContent = message;
                let bgColor = '';
                if (type === 'success') {
                    bgColor = 'bg-green-500';
                } else if (type === 'error') {
                    bgColor = 'bg-red-500';
                } else {
                    bgColor = 'bg-blue-500';
                }
                msgBox.className = `message-box ${bgColor} text-white`;
                document.body.appendChild(msgBox);
                setTimeout(() => msgBox.remove(), 3000);
            };

            /**
             * Renders the NFL teams list.
             */
            const renderTeamsList = () => {
                teamsList.innerHTML = '';
                nflTeams.forEach(team => {
                    const li = document.createElement('li');
                    const button = document.createElement('button');
                    button.textContent = team;
                    button.className = 'py-2 px-4 bg-gray-700 hover:bg-gray-600 text-white font-bold rounded-lg w-full text-center transition duration-200';
                    button.setAttribute('data-team', team);
                    button.addEventListener('click', () => {
                        showGameSettingsMenu(team);
                    });
                    li.appendChild(button);
                    teamsList.appendChild(li);
                });
            };

            /**
             * Loads last saved game from the browser's local storage.
             */
            const loadLastGameData = () => {
                lastSavedGame = localStorage.getItem('lastSavedGame');
                
                // Show/hide the "Load Last Game" button
                if (lastSavedGame) {
                    loadGameBtn.classList.remove('hidden');
                } else {
                    loadGameBtn.classList.add('hidden');
                }
            };

            /**
             * Saves the last saved game to the browser's local storage.
             */
            const saveGameData = () => {
                if (lastSavedGame) {
                    localStorage.setItem('lastSavedGame', lastSavedGame);
                    showMessage('Game saved!', 'success');
                    // Update the "Load Last Game" button visibility
                    loadLastGameData();
                }
            };
            
            /**
             * Starts a game by displaying it in the iframe.
             * @param {string} code The code to load into the iframe.
             */
            const startGame = (code) => {
                // Set the current game code for saving
                currentGameCode = code;

                // Hide menus and show the game screen
                mainMenu.classList.add('hidden');
                quickPlayMenu.classList.add('hidden');
                franchiseMenu.classList.add('hidden');
                newLeagueMenu.classList.add('hidden');
                gameSettingsMenu.classList.add('hidden');
                gameScreen.classList.remove('hidden');

                // Load the game code into the iframe
                gameIframe.srcdoc = code;
            };
            
            /**
             * Handles saving the currently playing game.
             */
            const saveCurrentGame = () => {
                if (currentGameCode) {
                    lastSavedGame = currentGameCode;
                    saveGameData();
                } else {
                    showMessage('No game to save!', 'error');
                }
            };
            
            /**
             * Handles loading the last saved game.
             */
            const loadLastGame = () => {
                if (lastSavedGame) {
                    startGame(lastSavedGame);
                    showMessage('Loaded last saved game!', 'success');
                } else {
                    showMessage('No saved game found!', 'error');
                }
            };

            /**
             * Handles the back button on the game screen.
             */
            const backToMenuFromGame = () => {
                gameScreen.classList.add('hidden');
                mainMenu.classList.remove('hidden');
                // Stop the game and clear the iframe
                gameIframe.srcdoc = '';
                currentGameCode = '';
            };

            /**
             * Hides all other menus and displays the main menu.
             */
            const showMainMenu = () => {
                quickPlayMenu.classList.add('hidden');
                franchiseMenu.classList.add('hidden');
                newLeagueMenu.classList.add('hidden');
                gameSettingsMenu.classList.add('hidden');
                gameScreen.classList.add('hidden');
                mainMenu.classList.remove('hidden');
                loadLastGameData();
            };

            /**
             * Hides all other menus and displays the quick play menu.
             */
            const showQuickPlayMenu = () => {
                mainMenu.classList.add('hidden');
                gameSettingsMenu.classList.add('hidden');
                quickPlayMenu.classList.remove('hidden');
            };

            /**
             * Hides all other menus and displays the franchise menu.
             */
            const showFranchiseMenu = () => {
                mainMenu.classList.add('hidden');
                newLeagueMenu.classList.add('hidden');
                franchiseMenu.classList.remove('hidden');
            };

            /**
             * Hides all other menus and displays the new league menu.
             */
            const showNewLeagueMenu = () => {
                franchiseMenu.classList.add('hidden');
                newLeagueMenu.classList.remove('hidden');
            };
            
            /**
             * Displays the game settings menu and hides the quick play menu.
             */
            const showGameSettingsMenu = (teamName) => {
                quickPlayMenu.classList.add('hidden');
                gameSettingsMenu.classList.remove('hidden');
                // Optional: set a title for the settings screen based on the team
            };

            // Event listeners
            playFootballBtn.addEventListener('click', showQuickPlayMenu);
            franchiseBtn.addEventListener('click', showFranchiseMenu);
            loadGameBtn.addEventListener('click', loadLastGame);
            
            backToMenuFromQuickPlayBtn.addEventListener('click', showMainMenu);
            backToMenuFromFranchiseBtn.addEventListener('click', showMainMenu);

            createNewLeagueBtn.addEventListener('click', showNewLeagueMenu);
            backToFranchiseBtn.addEventListener('click', showFranchiseMenu);
            
            // Sliders for game settings
            quarterLengthInput.addEventListener('input', (event) => {
                quarterLengthValue.textContent = event.target.value;
            });
            gameTimeInput.addEventListener('input', (event) => {
                const minutes = Math.floor(event.target.value / 60);
                const seconds = event.target.value % 60;
                gameTimeValue.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            });
            
            document.getElementById('start-quick-play-btn').addEventListener('click', () => {
                // This is where you would build the game based on the selected settings
                // For now, we'll just start the placeholder football game
                startGame(footballGameCode);
            });
            
            document.getElementById('back-to-quick-play-btn').addEventListener('click', showQuickPlayMenu);
            backToMenuFromGameBtn.addEventListener('click', backToMenuFromGame);
            saveGameBtn.addEventListener('click', saveCurrentGame);

            // Initial setup
            loadLastGameData();
            renderTeamsList();
        });
    </script>

</body>
</html>

