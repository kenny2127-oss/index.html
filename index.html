<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokémon Adventure</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #1a202c;
            color: #e6eef8;
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
        }
        .tab-content { display: none; padding-bottom: 6rem; }
        .tab-content.is-active { display: block; }
        .tab-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            display: flex;
            background: #2d3748;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.3);
            z-index: 1000;
        }
        .tab-footer button {
            flex: 1;
            background-color: transparent;
            border: none;
            padding: 1rem 0.5rem;
            cursor: pointer;
            color: white;
            transition: background-color 0.3s, color 0.3s;
            font-weight: bold;
            font-size: 0.8rem;
        }
        .tab-footer button.is-active {
            background: #4299e1;
            color: #ffffff;
        }
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px); align-items: center; justify-content: center; }
        .modal.is-active { display: flex; }
        .modal-content { background-color: #2d3748; margin: auto; padding: 2rem; border-radius: 1rem; width: 90%; max-width: 400px; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }
    </style>
</head>
<body class="antialiased">

<!-- Accessibility Live Region -->
<div id="accessibilityLive" aria-live="polite" class="sr-only"></div>

<!-- Modal for displaying messages -->
<div id="messageModal" class="modal">
    <div class="modal-content">
        <h3 id="messageTitle" class="text-xl font-bold mb-4"></h3>
        <p id="messageText" class="mb-6"></p>
        <button onclick="hideMessage()" class="bg-blue-500 text-white font-bold py-2 px-6 rounded-lg shadow-lg hover:bg-blue-600 transition duration-300 focus:outline-none focus:ring-2 focus:ring-blue-400">OK</button>
    </div>
</div>

<header class="p-4 text-center">
    <h1 class="text-4xl font-bold text-yellow-400 tracking-wider">Pokémon Adventure</h1>
</header>

<main class="container mx-auto p-4">
    <!-- Home Tab -->
    <section id="home" class="tab-content is-active">
        <div class="bg-gray-800 p-6 rounded-xl shadow-lg">
            <h2 class="text-2xl font-semibold mb-4 text-center">Pokédex</h2>
            <div id="pokedex" class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-3"></div>
        </div>
        <div class="flex flex-col sm:flex-row gap-4 mt-6">
            <button onclick="catchPokemon()" class="w-full bg-green-500 text-white font-bold py-3 rounded-lg shadow-md hover:bg-green-600 transition duration-300">Catch Pokémon</button>
            <button onclick="dailyReward()" class="w-full bg-yellow-500 text-gray-900 font-bold py-3 rounded-lg shadow-md hover:bg-yellow-600 transition duration-300">Daily Reward</button>
        </div>
    </section>

    <!-- Explore Tab -->
    <section id="explore" class="tab-content">
        <div class="bg-gray-800 p-6 rounded-xl shadow-lg text-center">
            <h2 class="text-2xl font-semibold mb-2">Explore</h2>
   ,          <p class="text-gray-400 mb-4">Click below to find a new Pokémon!</p>
            <button onclick="catchPokemon()" class="w-full bg-green-500 text-white font-bold py-3 rounded-lg shadow-md hover:bg-green-600 transition duration-300">Catch Pokémon</button>
        </div>
    </section>

    <!-- Gather Tab -->
    <section id="gather" class="tab-content">
        <div class="bg-gray-800 p-6 rounded-xl shadow-lg">
            <h2 class="text-2xl font-semibold mb-4 text-center">Gather Resources</h2>
            <p class="text-gray-400 mb-2">Click to gather resources and gain experience.</p>
            <div class="flex justify-between items-center text-sm font-semibold mb-2">
                <span>Level: <span id="playerLevel">1</span></span>
                <span>Exp: <span id="playerExp">0</span>/<span id="expToNextLevel">100</span></span>
            </div>
            <div class="w-full bg-gray-600 rounded-full h-4 overflow-hidden">
                <div id="expBar" class="bg-green-500 h-full transition-all duration-500" style="width: 0%;"></div>
            </div>
            <button onclick="gatherResources()" class="w-full bg-indigo-500 text-white font-bold py-3 rounded-lg shadow-md mt-4 hover:bg-indigo-600 transition duration-300">Gather</button>
        </div>
    </section>

    <!-- Inventory Tab -->
    <section id="inventory" class="tab-content">
        <div class="bg-gray-800 p-6 rounded-xl shadow-lg">
            <h2 class="text-2xl font-semibold mb-4 text-center">Inventory</h2>
            <div id="moneyDisplay" class="text-center text-lg font-bold mb-4 text-yellow-400"></div>
            <div id="inventoryItems" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4"></div>
        </div>
    </section>

    <!-- Poké Mart Tab -->
    <section id="pokemart" class="tab-content">
        <div class="bg-gray-800 p-6 rounded-xl shadow-lg">
            <h2 class="text-2xl font-semibold mb-4 text-center">Poké Mart</h2>
            <p class="text-gray-400 mb-4 text-center">Sell your items here!</p>
            <div id="martItems" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4"></div>
        </div>
    </section>

    <!-- Trade Tab -->
    <section id="trade" class="tab-content">
        <div class="bg-gray-800 p-6 rounded-xl shadow-lg">
            <h2 class="text-2xl font-semibold mb-4 text-center">Trade Pokémon</h2>
            <p class="text-gray-400 mb-4 text-center">Generate a code to trade a random Pokémon with a friend.</p>
            <label for="exportData" class="block mb-2 text-sm text-gray-400">Your Trade Code:</label>
            <textarea id="exportData" readonly class="w-full p-2 bg-gray-700 rounded-lg text-gray-100 border border-gray-600" placeholder="Click button to generate code..."></textarea>
            <button onclick="exportPokedex()" class="w-full bg-blue-500 text-white font-bold py-3 rounded-lg shadow-md mt-4 hover:bg-blue-600 transition duration-300">Generate Trade Code</button>
            
            <hr class="my-6 border-gray-600">

            <label for="importData" class="block mb-2 text-sm text-gray-400">Enter Friend's Code:</label>
            <textarea id="importData" class="w-full p-2 bg-gray-700 rounded-lg text-gray-100 border border-gray-600" placeholder="Enter trade code here..."></textarea>
            <button onclick="importPokedex()" class="w-full bg-purple-500 text-white font-bold py-3 rounded-lg shadow-md mt-4 hover:bg-purple-600 transition duration-300">Complete Trade</button>
        </div>
    </section>
</main>

<footer id="tab-footer" class="tab-footer" role="tablist">
    <button onclick="switchTab('home')" role="tab" data-tab="home" class="is-active" aria-selected="true">Home</button>
    <button onclick="switchTab('explore')" role="tab" data-tab="explore" aria-selected="false">Explore</button>
    <button onclick="switchTab('gather')" role="tab" data-tab="gather" aria-selected="false">Gather</button>
    <button,  onclick="switchTab('inventory')" role="tab" data-tab="inventory" aria-selected="false">Inventory</button>
    <button onclick="switchTab('pokemart')" role="tab" data-tab="pokemart" aria-selected="false">Poké Mart</button>
    <button onclick="switchTab('trade')" role="tab" data-tab="trade" aria-selected="false">Trade</button>
</footer>

<script>
    // --- Game Data & Configuration ---
    const pokemonList = ["Bulbasaur", "Charmander", "Squirtle", "Pikachu", "Jigglypuff", "Meowth", "Psyduck", "Snorlax", "Eevee", "Magikarp", "Gengar", "Abra"];
    let pokedex = [];
    let items = { "Potion": 0, "Poké Ball": 0, "Rare Candy": 0, "Berries": 0, "Stones": 0 };
    let playerState = { level: 1, exp: 0, money: 0 };
    const EXP_PER_LEVEL = 100;
    const GATHER_EXP_GAIN = 10;
    const ITEM_PRICES = { "Potion": 50, "Poké Ball": 100, "Rare Candy": 500, "Berries": 5, "Stones": 20 };
    
    // --- Modal Message Functions ---
    /**
     * Shows a modal message with a given title and text.
     * @param {string} title The title of the message.
     * @param {string} text The body of the message.
     */
    function showMessage(title, text) {
        document.getElementById('messageTitle').textContent = title;
        document.getElementById('messageText').textContent = text;
        document.getElementById('messageModal').classList.add('is-active');
        announceForAccessibility(`${title}. ${text}`);
    }

    /**
     * Hides the modal message.
     */
    function hideMessage() {
        document.getElementById('messageModal').classList.remove('is-active');
    }

    // --- Accessibility ---
    /**
     * Announces a message for screen readers by updating a live region.
     * @param {string} message The text to be announced.
     */
    function announceForAccessibility(message) {
        const liveRegion = document.getElementById("accessibilityLive");
        liveRegion.textContent = ''; 
        setTimeout(() => { liveRegion.textContent = message; }, 100);
    }

    // --- Tab Switching ---
    /**
     * Switches the active tab based on the provided tab ID.
     * @param {string} newTabId The data-tab ID of the tab to switch to.
     */
    function switchTab(newTabId) {
        const currentActiveButton = document.querySelector('.tab-footer button.is-active');
        const currentActiveTabContent = document.querySelector('.tab-content.is-active');
        const newButton = document.querySelector(`.tab-footer button[data-tab='${newTabId}']`);
        const newTabContent = document.getElementById(newTabId);

        if (currentActiveButton) {
            currentActiveButton.classList.remove('is-active');
            currentActiveButton.setAttribute('aria-selected', 'false');
        }
        if (currentActiveTabContent) {
            currentActiveTabContent.classList.remove('is-active');
        }

        if (newButton) {
            newButton.classList.add('is-active');
            newButton.setAttribute('aria-selected', 'true');
        }
        if (newTabContent) {
            newTabContent.classList.add('is-active');
        }
        
        announceForAccessibility(`${newButton.textContent} tab selected`);

        if (newTabId === "inventory") renderInventory();
        if (newTabId === "pokemart") renderPokemart();
    }

    // --- Game Data Persistence ---
    function saveGame() {
        localStorage.setItem("pokedex_adventure_pokedex", JSON.stringify(pokedex));
        localStorage.setItem("pokedex_adventure_items", JSON.stringify(items));
        localStorage.setItem("pokedex_adventure_playerState", JSON.stringify(playerState));
    }

    function loadGame() {
        const savedPokedex = localStorage.getItem("pokedex_adventure_pokedex");
        const savedItems = localStorage.getItem("pokedex_adventure_items");
        const savedPlayerState = localStorage.getItem("pokedex_adventure_playerState");

        if (savedPokedex) {
            pokedex = JSON.parse(savedPokedex);
        } else {
      ,       // Start with a couple of default Pokémon if there's no saved data
            pokedex = ["Bulbasaur", "Charmander"];
        }
        if (savedItems) items = JSON.parse(savedItems);
        if (savedPlayerState) playerState = JSON.parse(savedPlayerState);
        
        renderPokedex();
        renderGatherUI();
        renderInventory();
    }

    // --- UI Rendering Functions ---
    function renderPokedex() {
        const container = document.getElementById("pokedex");
        container.innerHTML = pokemonList.map(p => `
            <div class="card bg-gray-700 rounded-lg p-2 text-center shadow-inner text-sm ${pokedex.includes(p) ? 'text-white' : 'text-gray-500'}">
                ${pokedex.includes(p) ? p : "???"}
            </div>
        `).join('');
    }

    function renderGatherUI() {
        const expNeeded = EXP_PER_LEVEL * playerState.level;
        document.getElementById("playerLevel").textContent = playerState.level;
        document.getElementById("playerExp").textContent = playerState.exp;
        document.getElementById("expToNextLevel").textContent = expNeeded;
        document.getElementById("expBar").style.width = `${(playerState.exp / expNeeded) * 100}%`;
    }

    function renderInventory() {
        const container = document.getElementById("inventoryItems");
        container.innerHTML = ""; // Clear previous items
        document.getElementById("moneyDisplay").textContent = `💰 ${playerState.money}`;
        
        let hasItems = false;
        for (const item in items) {
            if (items[item] > 0) {
                hasItems = true;
                const card = document.createElement("div");
                card.className = "card bg-gray-700 rounded-lg p-3 text-center shadow-inner text-sm";
                card.innerHTML = `<p class="font-bold">${item}</p><p>x${items[item]}</p>`;
                container.appendChild(card);
            }
        }
        if (!hasItems) {
            container.innerHTML = `<p class="col-span-full text-center text-gray-400">Your inventory is empty.</p>`;
        }
    }

    function renderPokemart() {
        const container = document.getElementById("martItems");
        container.innerHTML = ""; // Clear previous items

        let hasItemsToSell = false;
        for (const item in items) {
            if (items[item] > 0) {
                hasItemsToSell = true;
                const card = document.createElement("div");
                card.className = "card bg-gray-700 rounded-lg p-3 text-center shadow-inner text-sm flex flex-col justify-between";
                card.innerHTML = `
                    <div>
                        <p class="font-bold">${item}</p>
                        <p>x${items[item]}</p>
                        <p class="text-xs text-yellow-400">Value: 💰${ITEM_PRICES[item]}</p>
                    </div>
                    <div class="flex flex-col gap-2 mt-2">
                        <button onclick="sellItem('${item}')" class="w-full bg-yellow-500 text-gray-900 font-bold py-1 rounded-md text-xs hover:bg-yellow-600 transition duration-300">Sell One</button>
                        <button onclick="sellAllItems('${item}')" class="w-full bg-red-500 text-white font-bold py-1 rounded-md text-xs hover:bg-red-600 transition duration-300">Sell All</button>
                    </div>`;
                container.appendChild(card);
            }
        }
        if (!hasItemsToSell) {
            container.innerHTML = `<p class="col-span-full text-center text-gray-400">You have no items to sell.</p>`;
        }
    }

    // --- Game Logic ---
    function catchPokemon() {
        const found = pokemonList[Math.floor(Math.random() * pokemonList.length)];
        if (!pokedex.includes(found)) {
            pokedex.push(found);
            showMessage("New Catch!", `You found a wild ${found}! It has been added to your Pokédex.`);
        } else {
            showMessage("Already Caught!", `You encountered a ${found}, which,  is already in your Pokédex.`);
        }
        saveGame();
        renderPokedex();
    }

    function gatherResources() {
        const resources = ["Berries", "Stones"];
        const resourceFound = resources[Math.floor(Math.random() * resources.length)];
        const amount = Math.floor(Math.random() * 3) + 1;
        items[resourceFound] += amount;
        playerState.exp += GATHER_EXP_GAIN;
        checkLevelUp();
        saveGame();
        renderGatherUI();
        showMessage("Gathering Complete!", `You found ${amount} ${resourceFound}! You also gained ${GATHER_EXP_GAIN} EXP.`);
    }

    function checkLevelUp() {
        const expNeeded = EXP_PER_LEVEL * playerState.level;
        if (playerState.exp >= expNeeded) {
            playerState.level++;
            playerState.exp -= expNeeded; // Carry over extra exp
            showMessage("Level Up!", `Congratulations, you are now level ${playerState.level}!`);
            // Recursively check in case of multiple level ups
            checkLevelUp();
        }
    }

    function dailyReward() {
        const lastClaimed = localStorage.getItem("pokedex_adventure_lastDaily");
        const today = new Date().toDateString();
        if (lastClaimed === today) {
            showMessage("Daily Reward", "You have already claimed your daily reward today! Come back tomorrow.");
            return;
        }
        const rewardPokemon = pokemonList[Math.floor(Math.random() * pokemonList.length)];
        if (!pokedex.includes(rewardPokemon)) {
            pokedex.push(rewardPokemon);
        }
        items.Potion++;
        items["Poké Ball"] += 3;
        localStorage.setItem("pokedex_adventure_lastDaily", today);
        saveGame();
        renderPokedex();
        showMessage("Daily Reward Claimed!", `You received a ${rewardPokemon}, 1 Potion, and 3 Poké Balls!`);
    }
    
    function sellItem(item) {
        if (items[item] > 0) {
            items[item]--;
            playerState.money += ITEM_PRICES[item];
            saveGame();
            renderInventory();
            renderPokemart();
            showMessage("Item Sold!", `You sold one ${item} for 💰${ITEM_PRICES[item]}.`);
        } else {
            showMessage("Out of Stock!", `You have no more ${item} to sell.`);
        }
    }

    function sellAllItems(item) {
        if (items[item] > 0) {
            const count = items[item];
            const earnings = ITEM_PRICES[item] * count;
            items[item] = 0;
            playerState.money += earnings;
            saveGame();
            renderInventory();
            renderPokemart();
            showMessage("All Sold!", `You sold ${count} ${item}(s) for 💰${earnings}.`);
        } else {
            showMessage("Out of Stock!", `You have no ${item} to sell.`);
        }
    }

    // --- Trade Logic ---
    function exportPokedex() {
        if (pokedex.length === 0) {
            showMessage("Trade Error", "You need to catch at least one Pokémon before you can trade!");
            return;
        }
        const pokemonToTrade = pokedex[Math.floor(Math.random() * pokedex.length)];
        const tradeData = { pokemon: pokemonToTrade, timestamp: Date.now() };
        
        try {
            const encodedData = btoa(JSON.stringify(tradeData));
            const exportTextarea = document.getElementById('exportData');
            exportTextarea.value = encodedData;
            exportTextarea.select();
            document.execCommand('copy');
            showMessage("Code Generated!", `Your trade code for a ${pokemonToTrade} has been copied to your clipboard!`);
        } catch (e) {
            console.error("Encoding failed:", e);
            showMessage("Error", "Could not generate trade code.");
        }
    }

    function importPokedex() {
        const importText = document.getElementById('importData').value.trim();
        if (!importText) {
            showMessage("Trade Error", "Please enter a trade code.");
            return;
   ,      }

        try {
            const decodedData = atob(importText);
            const tradeData = JSON.parse(decodedData);

            if (tradeData && tradeData.pokemon) {
                if (!pokedex.includes(tradeData.pokemon)) {
                    pokedex.push(tradeData.pokemon);
                    saveGame();
                    renderPokedex();
                    showMessage("Trade Successful!", `You received a ${tradeData.pokemon} and it has been added to your Pokédex!`);
                } else {
                    showMessage("Trade Complete", `You received a ${tradeData.pokemon}, but you already had it in your Pokédex.`);
                }
                document.getElementById('importData').value = "";
            } else {
                throw new Error("Invalid trade data structure.");
            }
        } catch (e) {
            console.error("Decoding/Import failed:", e);
            showMessage("Trade Failed", "The code is invalid or corrupted. Please check the code and try again.");
        }
    }

    // --- Game Initialization ---
    document.addEventListener('DOMContentLoaded', () => {
        loadGame();
        document.getElementById('modalOkButton').addEventListener('click', hideMessage);
   ,  });

</script>

</body>
</html>