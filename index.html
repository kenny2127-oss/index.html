<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Reader</title>
    <!-- Tailwind CSS CDN for modern, mobile-friendly styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* bg-gray-900 */
            color: #e2e8f0; /* text-gray-200 */
        }
        .container {
            max-width: 640px;
            margin: auto;
            padding: 1rem;
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background-color: #2d3748; /* bg-gray-700 */
            padding: 1.5rem;
            border-radius: 0.75rem;
            max-width: 90%;
            text-align: center;
        }
    </style>
</head>
<body class="bg-gray-900 min-h-screen flex flex-col items-center justify-center py-8 px-4">

    <div class="container bg-gray-800 rounded-xl shadow-lg p-6 mb-6">
        <h1 class="text-3xl font-bold text-center text-indigo-400 mb-4">Voice Reader</h1>
        <p class="text-center text-sm mb-6 text-gray-400">
            Type or paste text below and click 'Read Aloud'.
        </p>

        <div class="mb-4">
            <textarea
                id="text-input"
                class="w-full h-48 p-3 bg-gray-700 rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none text-sm placeholder-gray-400"
                placeholder="Hello, I am your voice assistant. Type something here and I will read it for you."
            ></textarea>
        </div>

        <button
            id="read-aloud-btn"
            class="w-full py-3 px-4 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-lg transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
        >
            Read Aloud
        </button>

        <div id="status-message" class="mt-4 p-3 text-sm rounded-lg text-center hidden"></div>
    </div>

    <!-- Custom Modal for user feedback -->
    <div id="error-modal" class="modal hidden">
        <div class="modal-content">
            <h2 class="text-2xl font-bold text-red-400 mb-2">Sound Not Playing</h2>
            <p class="text-sm mb-4">
                The sound may be blocked by your browser. Please check the following:
            </p>
            <ul class="list-disc list-inside text-left mx-auto max-w-xs mb-4 text-sm text-gray-300">
                <li>Check that your **media volume** is turned up.</li>
                <li>Make sure your device is not in **silent mode**.</li>
                <li>Try closing and reopening the page.</li>
            </ul>
            <button id="close-modal-btn" class="py-2 px-4 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg transition duration-200">
                Got it
            </button>
        </div>
    </div>

    <script>
        // Get references to the HTML elements
        const textInput = document.getElementById('text-input');
        const readAloudBtn = document.getElementById('read-aloud-btn');
        const statusMessage = document.getElementById('status-message');
        const errorModal = document.getElementById('error-modal');
        const closeModalBtn = document.getElementById('close-modal-btn');

        let utterance = null;

        /**
         * Displays a status message to the user.
         * @param {string} message The message to display.
         * @param {string} className The Tailwind CSS class for styling.
         */
        const showStatusMessage = (message, className) => {
            statusMessage.textContent = message;
            statusMessage.className = `mt-4 p-3 text-sm rounded-lg text-center ${className}`;
            statusMessage.classList.remove('hidden');
        };

        /**
         * Shows the error modal with troubleshooting tips.
         */
        const showErrorModal = () => {
            errorModal.classList.remove('hidden');
        };

        /**
         * Handles the text-to-speech functionality when the button is clicked.
         */
        const handleReadAloud = () => {
            // If the speech is already in progress, stop it first
            if (window.speechSynthesis.speaking) {
                window.speechSynthesis.cancel();
            }

            const text = textInput.value.trim();

            // Check if there is any text to read
            if (!text) {
                showStatusMessage("Please enter some text to read.", 'bg-red-800 text-red-200');
                return;
            }
            
            // Check if the browser supports the Web Speech API
            if (!('speechSynthesis' in window)) {
                showStatusMessage("Sorry, your browser doesn't support Text-to-Speech.", 'bg-red-800 text-red-200');
                return;
            }

            try {
                // Create a new speech utterance object
                utterance = new SpeechSynthesisUtterance(text);
                
                // Add event listeners for feedback
                utterance.onstart = () => {
                    readAloudBtn.disabled = true;
                    showStatusMessage("Speaking...", 'bg-blue-800 text-blue-200');
                };

                utterance.onend = () => {
                    readAloudBtn.disabled = false;
                    showStatusMessage("Finished speaking.", 'bg-green-800 text-green-200');
                };

                utterance.onerror = (event) => {
                    readAloudBtn.disabled = false;
                    console.error('SpeechSynthesisError', event.error);
                    showStatusMessage("An error occurred.", 'bg-red-800 text-red-200');
                    showErrorModal();
                };

                // Use the device's default speech synthesis to speak the text
                window.speechSynthesis.speak(utterance);

            } catch (e) {
                console.error("Failed to speak text:", e);
                showStatusMessage("An unexpected error occurred while trying to speak.", 'bg-red-800 text-red-200');
                showErrorModal();
            }
        };

        // Event listeners
        readAloudBtn.addEventListener('click', handleReadAloud);
        closeModalBtn.addEventListener('click', () => {
            errorModal.classList.add('hidden');
        });
    </script>

</body>
</html>

